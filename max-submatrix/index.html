
<!DOCTYPE html>
<html lang="en">
<head>
  <script src="https://orthogonalscribe.github.io/js/theme.min.js" integrity="sha384-pb++s6uBRKaQv+iAXpgA/H3IlpLZdO14tTwuCI7uXmz4aaZdByoCcM+6BhynMq/1"></script>
  <link rel="stylesheet" href="https://orthogonalscribe.github.io/abridge.css?h=14396a693f76aa9d40ae" />
  <meta charset="utf-8" />
  <meta http-equiv="x-ua-compatible" content="ie=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="base" content="https://orthogonalscribe.github.io" />
  <meta name="HandheldFriendly" content="True" />
  <meta name="mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="default" />
  <link rel="apple-touch-icon" sizes="180x180" href="https://orthogonalscribe.github.io/favicon/apple-touch-icon.png" />
  <link rel="icon" type="image/png" sizes="32x32" href="https://orthogonalscribe.github.io/favicon/favicon/32x32.png" />
  <link rel="icon" type="image/png" sizes="16x16" href="https://orthogonalscribe.github.io/favicon/16x16.png" />
  <link rel="preload" as="style" class="preStyle" href="https://orthogonalscribe.github.io/katex.min.css" integrity="sha384-ZPe7yZ91iWxYumsBEOn7ieg8q/o+qh/hQpSaPow8T6BwALcXSCS6C6fSRPIAnTQs" />
  <link rel="alternate" type="application/atom+xml" title="OrthogonalScribe Atom/RSS Feed" href="https://orthogonalscribe.github.io/atom.xml" />
  <meta name="robots" content="index, follow" />
  <meta name="googlebot" content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1" />
  <meta name="bingbot" content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1" />
  <title>Maximum nonzero contiguous square submatrix | OrthogonalScribe</title>
  <meta name="author" content="OrthogonalScribe" />
  <meta name="copyright" content="OrthogonalScribe" />
  <meta name="description" content="Combining summed-area tables and another dynamic programming pattern to solve a competitive programming problem." />
  <link rel="canonical" href="https://orthogonalscribe.github.io/max-submatrix/" />
  <meta name="keywords" content="Algorithms, Competitive programming, Dynamic programming, C++, Algorithms, Dynamic Programming, OrthogonalScribe" />
  <meta property="og:url" content="https://orthogonalscribe.github.io/max-submatrix/" />
  <meta name="twitter:url" content="https://orthogonalscribe.github.io/max-submatrix/" />
  <meta property="og:description" content="Combining summed-area tables and another dynamic programming pattern to solve a competitive programming problem." />
  <meta name="twitter:description" content="Combining summed-area tables and another dynamic programming pattern to solve a competitive programming problem." />
  <meta property="og:title" content="Maximum nonzero contiguous square submatrix | OrthogonalScribe" />
  <meta name="twitter:title" content="Maximum nonzero contiguous square submatrix | OrthogonalScribe" />
  <meta name="twitter:card" content="summary" />
  <meta property="og:site_name" content="OrthogonalScribe" />
  <meta property="og:locale" content="en_US" />
  <meta property="og:type" content="website" />
  <meta property="og:updated_time" content="2024-04-17" />
  <script defer src="https://orthogonalscribe.github.io/js/abridge_nopwa.min.js?h=8442828faf62aeeb06cc" integrity="sha384-fe1/px0iuiAytN9SlS0F8uHXKk3P7UZwQWG+PDkhgP0ME96uFxSD2gOcTEG6xyrx"></script>
  <script defer src="https://orthogonalscribe.github.io/js/katexbundle.min.js?h=6299b774ae77579e4404" integrity="sha384-w2LtVhWr6g/pnU4E8ZCpuUruGnK6Kw2ykIJojhKGscTSRckItl1/sZigXdTjRkkI"></script>
  <noscript><link rel="stylesheet" href="https://orthogonalscribe.github.io/nojs.css" /></noscript>
</head>
<body>
  <header>
    <nav>
      <div><h1><a href="https://orthogonalscribe.github.io" title="OrthogonalScribe">OrthogonalScribe</a></h1></div>
      <div>

        <div>
          <ul><li><a class="s110" href="https://orthogonalscribe.github.io/projects/"> Projects </a></li><li><a class="s110" href="https://orthogonalscribe.github.io/archive/"> Posts </a></li><li><a class="s110" href="https://orthogonalscribe.github.io/tags/"> Tags </a></li><li><i type="reset" id="mode" class="js svgs adjust"></i></ul>
        </div>

        <div>
          <div>
            <form autocomplete=off class="js" name="goSearch" id="searchbox">
              <div class="searchd">
                <input id="searchinput" type="text" placeholder="Search" title="Search" />
                <button type="submit" title="Search" class="svgs search"></button>
              </div>
              <div class="results"><div id="suggestions"></div></div>
            </form>
          </div>
        </div>

      </div>
    </nav>
  </header>
  <main>
    <article>
      <h1><a href="https://orthogonalscribe.github.io/max-submatrix/">Maximum nonzero contiguous square submatrix</a></h1>

      <span class="s95"> OrthogonalScribe <span class="rpad"></span> March 20, 2024 <span class="rpad"></span>Updated: April 17, 2024 <span class="rpad"></span> #<a href="https://orthogonalscribe.github.io/tags/algorithms/">Algorithms</a>  #<a href="https://orthogonalscribe.github.io/tags/competitive-programming/">Competitive Programming</a>  #<a href="https://orthogonalscribe.github.io/tags/dynamic-programming/">Dynamic programming</a>  #<a href="https://orthogonalscribe.github.io/tags/c/">C++</a> </span>

    
        <div class="block">
      <div class="blockdiv">
        <a class="b s150" href="https://orthogonalscribe.github.io/tags/algorithms/">Algorithms (Series)</a>
        <ol>
            <li><a class="scur" href="https://orthogonalscribe.github.io/max-submatrix/">Maximum nonzero contiguous square submatrix</a></li> 
          
            <li><a href="https://orthogonalscribe.github.io/lc-332-reconstructing-itinerary/">LeetCode 332: Reconstructing Itinerary</a></li>
        </ol>
      </div>
    </div>


<p>This post shows how to combine two <em>DP</em> (<a href="https://en.wikipedia.org/wiki/Dynamic_programming">dynamic programming</a>) patterns—using a summed-area table, and taking advantage of a constraint in the problem statement—to solve a competitive programming problem in $\mathcal{O}(MN)$ time.</p>
<span id="continue-reading"></span><h2 id="problem-statement">Problem statement</h2>
<p>Given a matrix $A$ of non-negative integers with dimensions $M{\times}N$, find the first <em>NzCSS</em> (nonzero contiguous square submatrix) with the largest sum of elements.</p>
<p>Constraints:</p>
<ul>
<li>$M \leq 5000$</li>
<li>$N \leq 5000$</li>
<li>$ \sum_{i, j} A_{ij} &lt; 2^{64} $</li>
<li>the matrix contains at least one non-zero integer</li>
</ul>
<h2 id="example">Example</h2>
<p>First, we'll generate the <a href="https://orthogonalscribe.github.io/max-submatrix/input.txt">input data</a> we'll be using below:</p>
<pre data-lang="sh" class="language-sh z-code"><code class="language-sh" data-lang="sh"><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">$</span></span><span class="z-meta z-function-call z-arguments z-shell"> ./gen_input.py 15 10 2038 11<span class="z-variable z-parameter z-option z-shell"><span class="z-punctuation z-definition z-parameter z-shell"> --</span>max_val</span> 99</span> <span class="z-keyword z-operator z-logical z-pipe z-shell">|</span> <span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">column</span></span><span class="z-meta z-function-call z-arguments z-shell"><span class="z-variable z-parameter z-option z-shell"><span class="z-punctuation z-definition z-parameter z-shell"> -</span>t</span> <span class="z-keyword z-operator z-assignment z-redirection z-shell">&gt;</span> input.txt</span>
</span></code></pre>
<pre data-lang="txt" class="language-txt z-code"><code class="language-txt" data-lang="txt"><span class="z-text z-plain">15  10                              
</span><span class="z-text z-plain">61  0   69  2   22  39  42  2   0   59
</span><span class="z-text z-plain">71  10  11  45  73  18  88  62  16  14
</span><span class="z-text z-plain">13  0   98  48  93  0   72  79  1   74
</span><span class="z-text z-plain">71  57  54  0   18  8   31  74  62  90
</span><span class="z-text z-plain">82  0   34  75  4   54  58  35  92  73
</span><span class="z-text z-plain">4   86  43  37  11  34  71  92  23  0
</span><span class="z-text z-plain">60  73  0   58  43  64  88  60  88  99
</span><span class="z-text z-plain">13  49  81  23  14  36  96  35  18  81
</span><span class="z-text z-plain">73  31  0   18  27  11  29  43  13  20
</span><span class="z-text z-plain">27  1   24  25  12  77  16  0   42  0
</span><span class="z-text z-plain">22  77  40  63  20  68  33  9   76  41
</span><span class="z-text z-plain">11  21  0   39  9   56  84  37  84  39
</span><span class="z-text z-plain">45  21  19  40  60  49  96  33  52  34
</span><span class="z-text z-plain">15  83  26  0   88  65  90  29  19  42
</span><span class="z-text z-plain">0   46  35  50  4   8   42  9   63  31
</span></code></pre>
<p>The answer for which is a $5{\times}5$ region with an upper left corner at $(3,4)$ and a sum of $1209$:</p>
<pre data-lang="sh" class="language-sh z-code"><code class="language-sh" data-lang="sh"><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">$</span></span><span class="z-meta z-function-call z-arguments z-shell"> ./cutRegion.sc 3 4 7 8 <span class="z-keyword z-operator z-assignment z-redirection z-shell">&lt;</span> input.txt</span> <span class="z-keyword z-operator z-logical z-pipe z-shell">|</span> <span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">column</span></span><span class="z-meta z-function-call z-arguments z-shell"><span class="z-variable z-parameter z-option z-shell"><span class="z-punctuation z-definition z-parameter z-shell"> -</span>t</span></span>
</span></code></pre>
<pre data-lang="txt" class="language-txt z-code"><code class="language-txt" data-lang="txt"><span class="z-text z-plain">5   5
</span><span class="z-text z-plain">18  8   31  74  62
</span><span class="z-text z-plain">4   54  58  35  92
</span><span class="z-text z-plain">11  34  71  92  23
</span><span class="z-text z-plain">43  64  88  60  88
</span><span class="z-text z-plain">14  36  96  35  18
</span></code></pre>
<p><a href="https://orthogonalscribe.github.io/max-submatrix/gen_input.py"><code>gen_input.py</code></a> and <a href="https://orthogonalscribe.github.io/max-submatrix/cutRegion.sc"><code>cutRegion.sc</code></a> can be found in the <a href="https://orthogonalscribe.github.io/max-submatrix/#helper-scripts">Helper scripts</a> section below.</p>
<h2 id="solution">Solution</h2>
<p>Our approach can be roughly divided into three steps:</p>
<ol>
<li>
<p>We use a summed-area table to be able to calculate the sum of any contiguous submatrix in $\mathcal{O}(1)$, after a $\mathcal{O}(MN)$ initialization step.</p>
</li>
<li>
<p>We take advantage of the constraint that there are no negative numbers to reduce the problem further: for each element $A_{ij}$, among all square submatrices that have it as a lower right corner, the widest one will have the largest sum. Thus, we can avoid processing all others, and are left with only $MN$ candidate submatrices to consider for the whole problem.</p>
</li>
<li>
<p>We use a similar DP approach to find the widest NzCSS with a lower right corner at $(i,j)$ in $\mathcal{O}(1)$, using those found for 3 of its immediate neighbors.</p>
</li>
</ol>
<h3 id="summed-area-table">Summed-area table</h3>
<p>We generate a <a href="https://en.wikipedia.org/wiki/Summed-area_table">summed-area table</a> (a 2D generalization of <a href="https://en.wikipedia.org/wiki/Prefix_sum">prefix sums</a>) $S$, such that $S_{ij}$ is the sum of all elements in the contiguous submatrix from $A_{00}$ to $A_{ij}$ (inclusive), or</p>
<p>$$S_{ij} = \sum_{i^\prime=0,j^\prime=0}^{i,j} A_{i^\prime j^\prime}$$</p>
<p>Much like prefix sums, their 2D generalization obeys a recurrence relation, albeit a slightly more complicated one:</p>
<p>$$
S_{ij} = A_{ij} +
\begin{cases}
0                                   &amp; \text{if } i=0, j=0     \\
S_{i,j-1}                           &amp; \text{if } i=0          \\
S_{i-1,j}                           &amp; \text{if } j=0          \\
S_{i-1,j} + S_{i,j-1} - S_{i-1,j-1} &amp; \text{otherwise}
\end{cases}
$$</p>
<p>which can be simplified to $$S_{ij} = A_{ij} +S_{i-1,j} + S_{i,j-1} - S_{i-1,j-1}$$ if we define $S_{ij}$ to be $0$ when $(i,j)$ is out of bounds, or appropriately skip the out of bounds coordinates in our code.</p>
<p>This allows us to generate the table using the following code:</p>
<pre data-linenos data-lang="c++" class="language-c++ z-code"><code class="language-c++" data-lang="c++"><table><tbody><tr><td>21</td><td><span class="z-source z-c++">    <span class="z-keyword z-control z-c++">for</span> <span class="z-meta z-group z-c++"><span class="z-punctuation z-section z-group z-begin z-c++">(</span><span class="z-storage z-type z-c">int</span> i<span class="z-keyword z-operator z-assignment z-c">=</span><span class="z-constant z-numeric z-integer z-decimal z-c++">0</span><span class="z-punctuation z-terminator z-c++">;</span> i<span class="z-keyword z-operator z-comparison z-c">&lt;</span>M<span class="z-punctuation z-terminator z-c++">;</span> i<span class="z-keyword z-operator z-arithmetic z-c">++</span><span class="z-punctuation z-section z-group z-end z-c++">)</span></span>
</span></td></tr><tr><td>22</td><td><span class="z-source z-c++">        <span class="z-keyword z-control z-c++">for</span> <span class="z-meta z-group z-c++"><span class="z-punctuation z-section z-group z-begin z-c++">(</span><span class="z-storage z-type z-c">int</span> j<span class="z-keyword z-operator z-assignment z-c">=</span><span class="z-constant z-numeric z-integer z-decimal z-c++">0</span><span class="z-punctuation z-terminator z-c++">;</span> j<span class="z-keyword z-operator z-comparison z-c">&lt;</span>N<span class="z-punctuation z-terminator z-c++">;</span> j<span class="z-keyword z-operator z-arithmetic z-c">++</span><span class="z-punctuation z-section z-group z-end z-c++">)</span></span> <span class="z-meta z-block z-c++"><span class="z-punctuation z-section z-block z-begin z-c++">{</span>
</span></span></td></tr><tr><td>23</td><td><span class="z-source z-c++"><span class="z-meta z-block z-c++">            S<span class="z-meta z-brackets z-c++"><span class="z-punctuation z-section z-brackets z-begin z-c++">[</span>i<span class="z-punctuation z-section z-brackets z-end z-c++">]</span></span><span class="z-meta z-brackets z-c++"><span class="z-punctuation z-section z-brackets z-begin z-c++">[</span>j<span class="z-punctuation z-section z-brackets z-end z-c++">]</span></span> <span class="z-keyword z-operator z-assignment z-c">=</span> A<span class="z-meta z-brackets z-c++"><span class="z-punctuation z-section z-brackets z-begin z-c++">[</span>i<span class="z-punctuation z-section z-brackets z-end z-c++">]</span></span><span class="z-meta z-brackets z-c++"><span class="z-punctuation z-section z-brackets z-begin z-c++">[</span>j<span class="z-punctuation z-section z-brackets z-end z-c++">]</span></span><span class="z-punctuation z-terminator z-c++">;</span>
</span></span></td></tr><tr><td>24</td><td><span class="z-source z-c++"><span class="z-meta z-block z-c++">
</span></span></td></tr><tr><td>25</td><td><span class="z-source z-c++"><span class="z-meta z-block z-c++">            <span class="z-keyword z-control z-c++">if</span> <span class="z-meta z-group z-c++"><span class="z-punctuation z-section z-group z-begin z-c++">(</span>i <span class="z-keyword z-operator z-comparison z-c">==</span> <span class="z-constant z-numeric z-integer z-decimal z-c++">0</span> <span class="z-keyword z-operator z-arithmetic z-c">&amp;&amp;</span> j <span class="z-keyword z-operator z-comparison z-c">==</span> <span class="z-constant z-numeric z-integer z-decimal z-c++">0</span><span class="z-punctuation z-section z-group z-end z-c++">)</span></span>
</span></span></td></tr><tr><td>26</td><td><span class="z-source z-c++"><span class="z-meta z-block z-c++">                <span class="z-keyword z-control z-flow z-continue z-c++">continue</span><span class="z-punctuation z-terminator z-c++">;</span>
</span></span></td></tr><tr><td>27</td><td><span class="z-source z-c++"><span class="z-meta z-block z-c++">
</span></span></td></tr><tr><td>28</td><td><span class="z-source z-c++"><span class="z-meta z-block z-c++">            <span class="z-keyword z-control z-c++">if</span> <span class="z-meta z-group z-c++"><span class="z-punctuation z-section z-group z-begin z-c++">(</span>i <span class="z-keyword z-operator z-comparison z-c">&gt;</span> <span class="z-constant z-numeric z-integer z-decimal z-c++">0</span><span class="z-punctuation z-section z-group z-end z-c++">)</span></span>
</span></span></td></tr><tr><td>29</td><td><span class="z-source z-c++"><span class="z-meta z-block z-c++">                S<span class="z-meta z-brackets z-c++"><span class="z-punctuation z-section z-brackets z-begin z-c++">[</span>i<span class="z-punctuation z-section z-brackets z-end z-c++">]</span></span><span class="z-meta z-brackets z-c++"><span class="z-punctuation z-section z-brackets z-begin z-c++">[</span>j<span class="z-punctuation z-section z-brackets z-end z-c++">]</span></span> <span class="z-keyword z-operator z-assignment z-augmented z-c">+=</span> S<span class="z-meta z-brackets z-c++"><span class="z-punctuation z-section z-brackets z-begin z-c++">[</span>i<span class="z-keyword z-operator z-arithmetic z-c">-</span><span class="z-constant z-numeric z-integer z-decimal z-c++">1</span><span class="z-punctuation z-section z-brackets z-end z-c++">]</span></span><span class="z-meta z-brackets z-c++"><span class="z-punctuation z-section z-brackets z-begin z-c++">[</span>j<span class="z-punctuation z-section z-brackets z-end z-c++">]</span></span><span class="z-punctuation z-terminator z-c++">;</span>
</span></span></td></tr><tr><td>30</td><td><span class="z-source z-c++"><span class="z-meta z-block z-c++">
</span></span></td></tr><tr><td>31</td><td><span class="z-source z-c++"><span class="z-meta z-block z-c++">            <span class="z-keyword z-control z-c++">if</span> <span class="z-meta z-group z-c++"><span class="z-punctuation z-section z-group z-begin z-c++">(</span>j <span class="z-keyword z-operator z-comparison z-c">&gt;</span> <span class="z-constant z-numeric z-integer z-decimal z-c++">0</span><span class="z-punctuation z-section z-group z-end z-c++">)</span></span>
</span></span></td></tr><tr><td>32</td><td><span class="z-source z-c++"><span class="z-meta z-block z-c++">                S<span class="z-meta z-brackets z-c++"><span class="z-punctuation z-section z-brackets z-begin z-c++">[</span>i<span class="z-punctuation z-section z-brackets z-end z-c++">]</span></span><span class="z-meta z-brackets z-c++"><span class="z-punctuation z-section z-brackets z-begin z-c++">[</span>j<span class="z-punctuation z-section z-brackets z-end z-c++">]</span></span> <span class="z-keyword z-operator z-assignment z-augmented z-c">+=</span> S<span class="z-meta z-brackets z-c++"><span class="z-punctuation z-section z-brackets z-begin z-c++">[</span>i<span class="z-punctuation z-section z-brackets z-end z-c++">]</span></span><span class="z-meta z-brackets z-c++"><span class="z-punctuation z-section z-brackets z-begin z-c++">[</span>j<span class="z-keyword z-operator z-arithmetic z-c">-</span><span class="z-constant z-numeric z-integer z-decimal z-c++">1</span><span class="z-punctuation z-section z-brackets z-end z-c++">]</span></span><span class="z-punctuation z-terminator z-c++">;</span>
</span></span></td></tr><tr><td>33</td><td><span class="z-source z-c++"><span class="z-meta z-block z-c++">
</span></span></td></tr><tr><td>34</td><td><span class="z-source z-c++"><span class="z-meta z-block z-c++">            <span class="z-keyword z-control z-c++">if</span> <span class="z-meta z-group z-c++"><span class="z-punctuation z-section z-group z-begin z-c++">(</span>i <span class="z-keyword z-operator z-comparison z-c">&gt;</span> <span class="z-constant z-numeric z-integer z-decimal z-c++">0</span> <span class="z-keyword z-operator z-arithmetic z-c">&amp;&amp;</span> j <span class="z-keyword z-operator z-comparison z-c">&gt;</span> <span class="z-constant z-numeric z-integer z-decimal z-c++">0</span><span class="z-punctuation z-section z-group z-end z-c++">)</span></span>
</span></span></td></tr><tr><td>35</td><td><span class="z-source z-c++"><span class="z-meta z-block z-c++">                S<span class="z-meta z-brackets z-c++"><span class="z-punctuation z-section z-brackets z-begin z-c++">[</span>i<span class="z-punctuation z-section z-brackets z-end z-c++">]</span></span><span class="z-meta z-brackets z-c++"><span class="z-punctuation z-section z-brackets z-begin z-c++">[</span>j<span class="z-punctuation z-section z-brackets z-end z-c++">]</span></span> <span class="z-keyword z-operator z-assignment z-augmented z-c">-=</span> S<span class="z-meta z-brackets z-c++"><span class="z-punctuation z-section z-brackets z-begin z-c++">[</span>i<span class="z-keyword z-operator z-arithmetic z-c">-</span><span class="z-constant z-numeric z-integer z-decimal z-c++">1</span><span class="z-punctuation z-section z-brackets z-end z-c++">]</span></span><span class="z-meta z-brackets z-c++"><span class="z-punctuation z-section z-brackets z-begin z-c++">[</span>j<span class="z-keyword z-operator z-arithmetic z-c">-</span><span class="z-constant z-numeric z-integer z-decimal z-c++">1</span><span class="z-punctuation z-section z-brackets z-end z-c++">]</span></span><span class="z-punctuation z-terminator z-c++">;</span>
</span></span></td></tr><tr><td>36</td><td><span class="z-source z-c++"><span class="z-meta z-block z-c++">        <span class="z-punctuation z-section z-block z-end z-c++">}</span></span>
</span></td></tr></tbody></table></code></pre>
<p>Using that table, we can calculate the sum of any contiguous submatrix in constant time. For example, the sum of all elements marked as <code>D</code> in</p>
<pre data-lang="txt" class="language-txt z-code"><code class="language-txt" data-lang="txt"><span class="z-text z-plain">A A A B B B B B
</span><span class="z-text z-plain">A A A B B B B B
</span><span class="z-text z-plain">C C C D D D D D
</span><span class="z-text z-plain">C C C D D D D D
</span><span class="z-text z-plain">C C C D D D D D
</span></code></pre>
<p>is <code>D - B - C + A</code>, using the values of $S$ at the lower right corner of each region (we re-add <code>A</code> to compensate for the elements that are subtracted twice via <code>B</code> and <code>C</code>).</p>
<p>More formally,</p>
<p>$$\sum_{i=i_0,j=j_0}^{i_1,j_1} A_{ij} =
S_{i_1,j_1} - S_{i_0-1,j_1} - S_{i_1,j_0-1} + S_{i_0-1,j_0-1}$$</p>
<p>if we define $S_{ij}$ to be $0$ when $(i,j)$ is out of bounds.</p>
<h3 id="widest-nzcss">Widest NzCSS</h3>
<p>The lack of negative numbers in the input matrix means that growing any contiguous submatrix will not result in a smaller sum of its elements. Further, the constraint of not having any zeroes in the sought contiguous submatrix means the sum will be strictly increasing. This means that for a given lower right corner at position $(i,j)$, instead of looking at all possible NzCSSs, we only need to consider the widest one.</p>
<p>Similarly to the previous section, we can take advantage of the calculations we've already done for previous coordinates to find the widest submatrix in constant time per coordinate. We generate a matrix $D$, such that $D_{ij}$ denotes the dimensions of the widest NzCSS with a lower right corner at $A_{ij}$. This obeys the following recurrence relation:</p>
<p>$$
D_{ij} =
\begin{cases}
0                                           &amp; \text{if } A_{ij} = 0                             \\
1                                           &amp; \text{if } A_{ij} \neq 0 \land (i = 0 \lor j = 0) \\
1 + \min(D_{i-1,j}, D_{i,j-1}, D_{i-1,j-1}) &amp; \text{otherwise}
\end{cases}
$$</p>
<p>In other words:</p>
<ul>
<li>if the element at the given coordinate is 0, the widest NzCSS is 0 too</li>
<li>if we're on the left or top edge of the matrix (with a non-zero element), the widest NzCSS is 1</li>
<li>otherwise the smallest of our west, north and northwest neighbor indicates how far the nearest zero or edge is, and we can increase that by one at our current position</li>
</ul>
<p>The above relation allows us to generate the matrix using the following code:</p>
<pre data-linenos data-lang="c++" class="language-c++ z-code"><code class="language-c++" data-lang="c++"><table><tbody><tr><td>38</td><td><span class="z-source z-c++">    <span class="z-keyword z-control z-c++">for</span> <span class="z-meta z-group z-c++"><span class="z-punctuation z-section z-group z-begin z-c++">(</span><span class="z-storage z-type z-c">int</span> i<span class="z-keyword z-operator z-assignment z-c">=</span><span class="z-constant z-numeric z-integer z-decimal z-c++">0</span><span class="z-punctuation z-terminator z-c++">;</span> i<span class="z-keyword z-operator z-comparison z-c">&lt;</span>M<span class="z-punctuation z-terminator z-c++">;</span> i<span class="z-keyword z-operator z-arithmetic z-c">++</span><span class="z-punctuation z-section z-group z-end z-c++">)</span></span>
</span></td></tr><tr><td>39</td><td><span class="z-source z-c++">        <span class="z-keyword z-control z-c++">for</span> <span class="z-meta z-group z-c++"><span class="z-punctuation z-section z-group z-begin z-c++">(</span><span class="z-storage z-type z-c">int</span> j<span class="z-keyword z-operator z-assignment z-c">=</span><span class="z-constant z-numeric z-integer z-decimal z-c++">0</span><span class="z-punctuation z-terminator z-c++">;</span> j<span class="z-keyword z-operator z-comparison z-c">&lt;</span>N<span class="z-punctuation z-terminator z-c++">;</span> j<span class="z-keyword z-operator z-arithmetic z-c">++</span><span class="z-punctuation z-section z-group z-end z-c++">)</span></span>
</span></td></tr><tr><td>40</td><td><span class="z-source z-c++">            <span class="z-keyword z-control z-c++">if</span> <span class="z-meta z-group z-c++"><span class="z-punctuation z-section z-group z-begin z-c++">(</span>A<span class="z-meta z-brackets z-c++"><span class="z-punctuation z-section z-brackets z-begin z-c++">[</span>i<span class="z-punctuation z-section z-brackets z-end z-c++">]</span></span><span class="z-meta z-brackets z-c++"><span class="z-punctuation z-section z-brackets z-begin z-c++">[</span>j<span class="z-punctuation z-section z-brackets z-end z-c++">]</span></span> <span class="z-keyword z-operator z-comparison z-c">==</span> <span class="z-constant z-numeric z-integer z-decimal z-c++">0</span><span class="z-punctuation z-section z-group z-end z-c++">)</span></span>
</span></td></tr><tr><td>41</td><td><span class="z-source z-c++">                D<span class="z-meta z-brackets z-c++"><span class="z-punctuation z-section z-brackets z-begin z-c++">[</span>i<span class="z-punctuation z-section z-brackets z-end z-c++">]</span></span><span class="z-meta z-brackets z-c++"><span class="z-punctuation z-section z-brackets z-begin z-c++">[</span>j<span class="z-punctuation z-section z-brackets z-end z-c++">]</span></span> <span class="z-keyword z-operator z-assignment z-c">=</span> <span class="z-constant z-numeric z-integer z-decimal z-c++">0</span><span class="z-punctuation z-terminator z-c++">;</span>
</span></td></tr><tr><td>42</td><td><span class="z-source z-c++">            <span class="z-keyword z-control z-c++">else</span> <span class="z-meta z-block z-c++"><span class="z-punctuation z-section z-block z-begin z-c++">{</span>
</span></span></td></tr><tr><td>43</td><td><span class="z-source z-c++"><span class="z-meta z-block z-c++">                D<span class="z-meta z-brackets z-c++"><span class="z-punctuation z-section z-brackets z-begin z-c++">[</span>i<span class="z-punctuation z-section z-brackets z-end z-c++">]</span></span><span class="z-meta z-brackets z-c++"><span class="z-punctuation z-section z-brackets z-begin z-c++">[</span>j<span class="z-punctuation z-section z-brackets z-end z-c++">]</span></span> <span class="z-keyword z-operator z-assignment z-c">=</span> <span class="z-constant z-numeric z-integer z-decimal z-c++">1</span><span class="z-punctuation z-terminator z-c++">;</span>
</span></span></td></tr><tr><td>44</td><td><span class="z-source z-c++"><span class="z-meta z-block z-c++">
</span></span></td></tr><tr><td>45</td><td><span class="z-source z-c++"><span class="z-meta z-block z-c++">                <span class="z-keyword z-control z-c++">if</span> <span class="z-meta z-group z-c++"><span class="z-punctuation z-section z-group z-begin z-c++">(</span>i <span class="z-keyword z-operator z-comparison z-c">==</span> <span class="z-constant z-numeric z-integer z-decimal z-c++">0</span> <span class="z-keyword z-operator z-arithmetic z-c">||</span> j <span class="z-keyword z-operator z-comparison z-c">==</span> <span class="z-constant z-numeric z-integer z-decimal z-c++">0</span><span class="z-punctuation z-section z-group z-end z-c++">)</span></span>
</span></span></td></tr><tr><td>46</td><td><span class="z-source z-c++"><span class="z-meta z-block z-c++">                    <span class="z-keyword z-control z-flow z-continue z-c++">continue</span><span class="z-punctuation z-terminator z-c++">;</span>
</span></span></td></tr><tr><td>47</td><td><span class="z-source z-c++"><span class="z-meta z-block z-c++">
</span></span></td></tr><tr><td>48</td><td><span class="z-source z-c++"><span class="z-meta z-block z-c++">                D<span class="z-meta z-brackets z-c++"><span class="z-punctuation z-section z-brackets z-begin z-c++">[</span>i<span class="z-punctuation z-section z-brackets z-end z-c++">]</span></span><span class="z-meta z-brackets z-c++"><span class="z-punctuation z-section z-brackets z-begin z-c++">[</span>j<span class="z-punctuation z-section z-brackets z-end z-c++">]</span></span> <span class="z-keyword z-operator z-assignment z-augmented z-c">+=</span> <span class="z-meta z-function-call z-c++">std<span class="z-punctuation z-accessor z-double-colon z-c++">::</span><span class="z-variable z-function z-c++">min</span><span class="z-meta z-group z-c++"><span class="z-punctuation z-section z-group z-begin z-c++">(</span></span></span><span class="z-meta z-function-call z-c++"><span class="z-meta z-group z-c++"><span class="z-meta z-block z-c++"><span class="z-punctuation z-section z-block z-begin z-c++">{</span>D<span class="z-meta z-brackets z-c++"><span class="z-punctuation z-section z-brackets z-begin z-c++">[</span>i<span class="z-keyword z-operator z-arithmetic z-c">-</span><span class="z-constant z-numeric z-integer z-decimal z-c++">1</span><span class="z-punctuation z-section z-brackets z-end z-c++">]</span></span><span class="z-meta z-brackets z-c++"><span class="z-punctuation z-section z-brackets z-begin z-c++">[</span>j<span class="z-punctuation z-section z-brackets z-end z-c++">]</span></span><span class="z-punctuation z-separator z-c++">,</span> D<span class="z-meta z-brackets z-c++"><span class="z-punctuation z-section z-brackets z-begin z-c++">[</span>i<span class="z-punctuation z-section z-brackets z-end z-c++">]</span></span><span class="z-meta z-brackets z-c++"><span class="z-punctuation z-section z-brackets z-begin z-c++">[</span>j<span class="z-keyword z-operator z-arithmetic z-c">-</span><span class="z-constant z-numeric z-integer z-decimal z-c++">1</span><span class="z-punctuation z-section z-brackets z-end z-c++">]</span></span><span class="z-punctuation z-separator z-c++">,</span> D<span class="z-meta z-brackets z-c++"><span class="z-punctuation z-section z-brackets z-begin z-c++">[</span>i<span class="z-keyword z-operator z-arithmetic z-c">-</span><span class="z-constant z-numeric z-integer z-decimal z-c++">1</span><span class="z-punctuation z-section z-brackets z-end z-c++">]</span></span><span class="z-meta z-brackets z-c++"><span class="z-punctuation z-section z-brackets z-begin z-c++">[</span>j<span class="z-keyword z-operator z-arithmetic z-c">-</span><span class="z-constant z-numeric z-integer z-decimal z-c++">1</span><span class="z-punctuation z-section z-brackets z-end z-c++">]</span></span><span class="z-punctuation z-section z-block z-end z-c++">}</span></span></span></span><span class="z-meta z-function-call z-c++"><span class="z-meta z-group z-c++"><span class="z-punctuation z-section z-group z-end z-c++">)</span></span></span><span class="z-punctuation z-terminator z-c++">;</span>
</span></span></td></tr><tr><td>49</td><td><span class="z-source z-c++"><span class="z-meta z-block z-c++">            <span class="z-punctuation z-section z-block z-end z-c++">}</span></span>
</span></td></tr></tbody></table></code></pre>
<h3 id="finding-the-result">Finding the result</h3>
<p>Using $S$ and $D$, we can now find the answer by simply finding for each coordinate, the maximum sum NzCSS with it as a lower right corner, and keeping the largest among those:</p>
<pre data-linenos data-lang="c++" class="language-c++ z-code"><code class="language-c++" data-lang="c++"><table><tbody><tr><td>54</td><td><span class="z-source z-c++">    <span class="z-keyword z-control z-c++">for</span> <span class="z-meta z-group z-c++"><span class="z-punctuation z-section z-group z-begin z-c++">(</span><span class="z-storage z-type z-c">int</span> i<span class="z-keyword z-operator z-assignment z-c">=</span><span class="z-constant z-numeric z-integer z-decimal z-c++">0</span><span class="z-punctuation z-terminator z-c++">;</span> i<span class="z-keyword z-operator z-comparison z-c">&lt;</span>M<span class="z-punctuation z-terminator z-c++">;</span> i<span class="z-keyword z-operator z-arithmetic z-c">++</span><span class="z-punctuation z-section z-group z-end z-c++">)</span></span>
</span></td></tr><tr><td>55</td><td><span class="z-source z-c++">        <span class="z-keyword z-control z-c++">for</span> <span class="z-meta z-group z-c++"><span class="z-punctuation z-section z-group z-begin z-c++">(</span><span class="z-storage z-type z-c">int</span> j<span class="z-keyword z-operator z-assignment z-c">=</span><span class="z-constant z-numeric z-integer z-decimal z-c++">0</span><span class="z-punctuation z-terminator z-c++">;</span> j<span class="z-keyword z-operator z-comparison z-c">&lt;</span>N<span class="z-punctuation z-terminator z-c++">;</span> j<span class="z-keyword z-operator z-arithmetic z-c">++</span><span class="z-punctuation z-section z-group z-end z-c++">)</span></span> <span class="z-meta z-block z-c++"><span class="z-punctuation z-section z-block z-begin z-c++">{</span>
</span></span></td></tr><tr><td>56</td><td><span class="z-source z-c++"><span class="z-meta z-block z-c++">            <span class="z-comment z-line z-double-slash z-c"><span class="z-punctuation z-definition z-comment z-c">//</span> Coordinates of *the upper left neighbor* of the upper left corner
</span></span></span></td></tr><tr><td>57</td><td><span class="z-source z-c++"><span class="z-meta z-block z-c++">            <span class="z-comment z-line z-double-slash z-c"><span class="z-punctuation z-definition z-comment z-c">//</span> of the widest nonzero contiguous square submatrix with a lower
</span></span></span></td></tr><tr><td>58</td><td><span class="z-source z-c++"><span class="z-meta z-block z-c++">            <span class="z-comment z-line z-double-slash z-c"><span class="z-punctuation z-definition z-comment z-c">//</span> right corner at (i,j)
</span></span></span></td></tr><tr><td>59</td><td><span class="z-source z-c++"><span class="z-meta z-block z-c++">            <span class="z-storage z-type z-c">int</span> ul_i <span class="z-keyword z-operator z-assignment z-c">=</span> i <span class="z-keyword z-operator z-arithmetic z-c">-</span> D<span class="z-meta z-brackets z-c++"><span class="z-punctuation z-section z-brackets z-begin z-c++">[</span>i<span class="z-punctuation z-section z-brackets z-end z-c++">]</span></span><span class="z-meta z-brackets z-c++"><span class="z-punctuation z-section z-brackets z-begin z-c++">[</span>j<span class="z-punctuation z-section z-brackets z-end z-c++">]</span></span><span class="z-punctuation z-terminator z-c++">;</span>
</span></span></td></tr><tr><td>60</td><td><span class="z-source z-c++"><span class="z-meta z-block z-c++">            <span class="z-storage z-type z-c">int</span> ul_j <span class="z-keyword z-operator z-assignment z-c">=</span> j <span class="z-keyword z-operator z-arithmetic z-c">-</span> D<span class="z-meta z-brackets z-c++"><span class="z-punctuation z-section z-brackets z-begin z-c++">[</span>i<span class="z-punctuation z-section z-brackets z-end z-c++">]</span></span><span class="z-meta z-brackets z-c++"><span class="z-punctuation z-section z-brackets z-begin z-c++">[</span>j<span class="z-punctuation z-section z-brackets z-end z-c++">]</span></span><span class="z-punctuation z-terminator z-c++">;</span>
</span></span></td></tr><tr><td>61</td><td><span class="z-source z-c++"><span class="z-meta z-block z-c++">
</span></span></td></tr><tr><td>62</td><td><span class="z-source z-c++"><span class="z-meta z-block z-c++">            <span class="z-support z-type z-stdint z-c">uint64_t</span> sum <span class="z-keyword z-operator z-assignment z-c">=</span> S<span class="z-meta z-brackets z-c++"><span class="z-punctuation z-section z-brackets z-begin z-c++">[</span>i<span class="z-punctuation z-section z-brackets z-end z-c++">]</span></span><span class="z-meta z-brackets z-c++"><span class="z-punctuation z-section z-brackets z-begin z-c++">[</span>j<span class="z-punctuation z-section z-brackets z-end z-c++">]</span></span><span class="z-punctuation z-terminator z-c++">;</span>
</span></span></td></tr><tr><td>63</td><td><span class="z-source z-c++"><span class="z-meta z-block z-c++">
</span></span></td></tr><tr><td>64</td><td><span class="z-source z-c++"><span class="z-meta z-block z-c++">            <span class="z-keyword z-control z-c++">if</span> <span class="z-meta z-group z-c++"><span class="z-punctuation z-section z-group z-begin z-c++">(</span>ul_i <span class="z-keyword z-operator z-comparison z-c">&gt;=</span> <span class="z-constant z-numeric z-integer z-decimal z-c++">0</span><span class="z-punctuation z-section z-group z-end z-c++">)</span></span>
</span></span></td></tr><tr><td>65</td><td><span class="z-source z-c++"><span class="z-meta z-block z-c++">                sum <span class="z-keyword z-operator z-assignment z-augmented z-c">-=</span> S<span class="z-meta z-brackets z-c++"><span class="z-punctuation z-section z-brackets z-begin z-c++">[</span>ul_i<span class="z-punctuation z-section z-brackets z-end z-c++">]</span></span><span class="z-meta z-brackets z-c++"><span class="z-punctuation z-section z-brackets z-begin z-c++">[</span>j<span class="z-punctuation z-section z-brackets z-end z-c++">]</span></span><span class="z-punctuation z-terminator z-c++">;</span>
</span></span></td></tr><tr><td>66</td><td><span class="z-source z-c++"><span class="z-meta z-block z-c++">
</span></span></td></tr><tr><td>67</td><td><span class="z-source z-c++"><span class="z-meta z-block z-c++">            <span class="z-keyword z-control z-c++">if</span> <span class="z-meta z-group z-c++"><span class="z-punctuation z-section z-group z-begin z-c++">(</span>ul_j <span class="z-keyword z-operator z-comparison z-c">&gt;=</span> <span class="z-constant z-numeric z-integer z-decimal z-c++">0</span><span class="z-punctuation z-section z-group z-end z-c++">)</span></span>
</span></span></td></tr><tr><td>68</td><td><span class="z-source z-c++"><span class="z-meta z-block z-c++">                sum <span class="z-keyword z-operator z-assignment z-augmented z-c">-=</span> S<span class="z-meta z-brackets z-c++"><span class="z-punctuation z-section z-brackets z-begin z-c++">[</span>i<span class="z-punctuation z-section z-brackets z-end z-c++">]</span></span><span class="z-meta z-brackets z-c++"><span class="z-punctuation z-section z-brackets z-begin z-c++">[</span>ul_j<span class="z-punctuation z-section z-brackets z-end z-c++">]</span></span><span class="z-punctuation z-terminator z-c++">;</span>
</span></span></td></tr><tr><td>69</td><td><span class="z-source z-c++"><span class="z-meta z-block z-c++">
</span></span></td></tr><tr><td>70</td><td><span class="z-source z-c++"><span class="z-meta z-block z-c++">            <span class="z-keyword z-control z-c++">if</span> <span class="z-meta z-group z-c++"><span class="z-punctuation z-section z-group z-begin z-c++">(</span>ul_i <span class="z-keyword z-operator z-comparison z-c">&gt;=</span> <span class="z-constant z-numeric z-integer z-decimal z-c++">0</span> <span class="z-keyword z-operator z-arithmetic z-c">&amp;&amp;</span> ul_j <span class="z-keyword z-operator z-comparison z-c">&gt;=</span> <span class="z-constant z-numeric z-integer z-decimal z-c++">0</span><span class="z-punctuation z-section z-group z-end z-c++">)</span></span>
</span></span></td></tr><tr><td>71</td><td><span class="z-source z-c++"><span class="z-meta z-block z-c++">                sum <span class="z-keyword z-operator z-assignment z-augmented z-c">+=</span> S<span class="z-meta z-brackets z-c++"><span class="z-punctuation z-section z-brackets z-begin z-c++">[</span>ul_i<span class="z-punctuation z-section z-brackets z-end z-c++">]</span></span><span class="z-meta z-brackets z-c++"><span class="z-punctuation z-section z-brackets z-begin z-c++">[</span>ul_j<span class="z-punctuation z-section z-brackets z-end z-c++">]</span></span><span class="z-punctuation z-terminator z-c++">;</span>
</span></span></td></tr><tr><td>72</td><td><span class="z-source z-c++"><span class="z-meta z-block z-c++">
</span></span></td></tr><tr><td>73</td><td><span class="z-source z-c++"><span class="z-meta z-block z-c++">            <span class="z-keyword z-control z-c++">if</span> <span class="z-meta z-group z-c++"><span class="z-punctuation z-section z-group z-begin z-c++">(</span>sum <span class="z-keyword z-operator z-comparison z-c">&gt;</span> maxSum<span class="z-punctuation z-section z-group z-end z-c++">)</span></span> <span class="z-meta z-block z-c++"><span class="z-punctuation z-section z-block z-begin z-c++">{</span>
</span></span></span></td></tr><tr><td>74</td><td><span class="z-source z-c++"><span class="z-meta z-block z-c++"><span class="z-meta z-block z-c++">                maxSum <span class="z-keyword z-operator z-assignment z-c">=</span> sum<span class="z-punctuation z-terminator z-c++">;</span>
</span></span></span></td></tr><tr><td>75</td><td><span class="z-source z-c++"><span class="z-meta z-block z-c++"><span class="z-meta z-block z-c++">                maxI <span class="z-keyword z-operator z-assignment z-c">=</span> i<span class="z-punctuation z-terminator z-c++">;</span>
</span></span></span></td></tr><tr><td>76</td><td><span class="z-source z-c++"><span class="z-meta z-block z-c++"><span class="z-meta z-block z-c++">                maxJ <span class="z-keyword z-operator z-assignment z-c">=</span> j<span class="z-punctuation z-terminator z-c++">;</span>
</span></span></span></td></tr><tr><td>77</td><td><span class="z-source z-c++"><span class="z-meta z-block z-c++"><span class="z-meta z-block z-c++">            <span class="z-punctuation z-section z-block z-end z-c++">}</span></span>
</span></span></td></tr><tr><td>78</td><td><span class="z-source z-c++"><span class="z-meta z-block z-c++">        <span class="z-punctuation z-section z-block z-end z-c++">}</span></span>
</span></td></tr></tbody></table></code></pre>
<h3 id="putting-it-all-together">Putting it all together</h3>
<p>The <a href="https://orthogonalscribe.github.io/max-submatrix/max-submatrix.cpp">full source code</a> is thus:</p>
<pre data-linenos data-lang="c++" class="language-c++ z-code"><code class="language-c++" data-lang="c++"><table><tbody><tr><td>1</td><td><span class="z-source z-c++"><span class="z-meta z-preprocessor z-include z-c++"><span class="z-keyword z-control z-import z-include z-c++">#include</span> <span class="z-string z-quoted z-other z-lt-gt z-include z-c++"><span class="z-punctuation z-definition z-string z-begin z-c++">&lt;</span>algorithm<span class="z-punctuation z-definition z-string z-end z-c++">&gt;</span></span>
</span></span></td></tr><tr><td>2</td><td><span class="z-source z-c++"><span class="z-meta z-preprocessor z-include z-c++"><span class="z-keyword z-control z-import z-include z-c++">#include</span> <span class="z-string z-quoted z-other z-lt-gt z-include z-c++"><span class="z-punctuation z-definition z-string z-begin z-c++">&lt;</span>cstdint<span class="z-punctuation z-definition z-string z-end z-c++">&gt;</span></span>
</span></span></td></tr><tr><td>3</td><td><span class="z-source z-c++"><span class="z-meta z-preprocessor z-include z-c++"><span class="z-keyword z-control z-import z-include z-c++">#include</span> <span class="z-string z-quoted z-other z-lt-gt z-include z-c++"><span class="z-punctuation z-definition z-string z-begin z-c++">&lt;</span>format<span class="z-punctuation z-definition z-string z-end z-c++">&gt;</span></span>
</span></span></td></tr><tr><td>4</td><td><span class="z-source z-c++"><span class="z-meta z-preprocessor z-include z-c++"><span class="z-keyword z-control z-import z-include z-c++">#include</span> <span class="z-string z-quoted z-other z-lt-gt z-include z-c++"><span class="z-punctuation z-definition z-string z-begin z-c++">&lt;</span>iostream<span class="z-punctuation z-definition z-string z-end z-c++">&gt;</span></span>
</span></span></td></tr><tr><td>5</td><td><span class="z-source z-c++"><span class="z-meta z-preprocessor z-include z-c++"><span class="z-keyword z-control z-import z-include z-c++">#include</span> <span class="z-string z-quoted z-other z-lt-gt z-include z-c++"><span class="z-punctuation z-definition z-string z-begin z-c++">&lt;</span>vector<span class="z-punctuation z-definition z-string z-end z-c++">&gt;</span></span>
</span></span></td></tr><tr><td>6</td><td><span class="z-source z-c++">
</span></td></tr><tr><td>7</td><td><span class="z-source z-c++"><span class="z-storage z-type z-c">int</span> <span class="z-meta z-function z-c++"><span class="z-meta z-toc-list z-full-identifier z-c++"><span class="z-entity z-name z-function z-c++">main</span></span></span><span class="z-meta z-function z-parameters z-c++"><span class="z-meta z-group z-c++"><span class="z-punctuation z-section z-group z-begin z-c++">(</span></span></span><span class="z-meta z-function z-parameters z-c++"><span class="z-meta z-group z-c++"><span class="z-punctuation z-section z-group z-end z-c++">)</span></span></span><span class="z-meta z-function z-c++"> </span><span class="z-meta z-function z-c++"><span class="z-meta z-block z-c++"><span class="z-punctuation z-section z-block z-begin z-c++">{</span></span></span><span class="z-meta z-function z-c++"><span class="z-meta z-block z-c++">
</span></span></span></td></tr><tr><td>8</td><td><span class="z-source z-c++"><span class="z-meta z-function z-c++"><span class="z-meta z-block z-c++">    <span class="z-storage z-type z-c">int</span> M<span class="z-punctuation z-separator z-c++">,</span> N<span class="z-punctuation z-terminator z-c++">;</span>
</span></span></span></td></tr><tr><td>9</td><td><span class="z-source z-c++"><span class="z-meta z-function z-c++"><span class="z-meta z-block z-c++">
</span></span></span></td></tr><tr><td>10</td><td><span class="z-source z-c++"><span class="z-meta z-function z-c++"><span class="z-meta z-block z-c++">    std<span class="z-punctuation z-accessor z-double-colon z-c++">::</span>cin <span class="z-keyword z-operator z-arithmetic z-c">&gt;&gt;</span> M <span class="z-keyword z-operator z-arithmetic z-c">&gt;&gt;</span> N<span class="z-punctuation z-terminator z-c++">;</span>
</span></span></span></td></tr><tr><td>11</td><td><span class="z-source z-c++"><span class="z-meta z-function z-c++"><span class="z-meta z-block z-c++">
</span></span></span></td></tr><tr><td>12</td><td><span class="z-source z-c++"><span class="z-meta z-function z-c++"><span class="z-meta z-block z-c++">    std<span class="z-punctuation z-accessor z-double-colon z-c++">::</span>vector<span class="z-punctuation z-section z-generic z-begin z-c++">&lt;</span>std<span class="z-punctuation z-accessor z-double-colon z-c++">::</span>vector<span class="z-punctuation z-section z-generic z-begin z-c++">&lt;</span><span class="z-support z-type z-stdint z-c">uint64_t</span><span class="z-punctuation z-section z-generic z-end z-c++">&gt;</span><span class="z-punctuation z-section z-generic z-end z-c++">&gt;</span>
</span></span></span></td></tr><tr><td>13</td><td><span class="z-source z-c++"><span class="z-meta z-function z-c++"><span class="z-meta z-block z-c++">        <span class="z-meta z-function-call z-c++"><span class="z-variable z-function z-c++">A</span><span class="z-meta z-group z-c++"><span class="z-punctuation z-section z-group z-begin z-c++">(</span></span></span><span class="z-meta z-function-call z-c++"><span class="z-meta z-group z-c++">M<span class="z-punctuation z-separator z-c++">,</span> <span class="z-meta z-function-call z-c++">std<span class="z-punctuation z-accessor z-double-colon z-c++">::</span><span class="z-variable z-function z-c++">vector</span><span class="z-punctuation z-section z-generic z-begin z-c++">&lt;</span><span class="z-support z-type z-stdint z-c">uint64_t</span><span class="z-punctuation z-section z-generic z-end z-c++">&gt;</span><span class="z-meta z-function-call z-c++"><span class="z-meta z-group z-c++"><span class="z-punctuation z-section z-group z-begin z-c++">(</span></span></span></span><span class="z-meta z-function-call z-c++"><span class="z-meta z-group z-c++">N</span><span class="z-meta z-group z-c++"><span class="z-punctuation z-section z-group z-end z-c++">)</span></span></span></span></span><span class="z-meta z-function-call z-c++"><span class="z-meta z-group z-c++"><span class="z-punctuation z-section z-group z-end z-c++">)</span></span></span><span class="z-punctuation z-separator z-c++">,</span>
</span></span></span></td></tr><tr><td>14</td><td><span class="z-source z-c++"><span class="z-meta z-function z-c++"><span class="z-meta z-block z-c++">        <span class="z-meta z-function-call z-c++"><span class="z-variable z-function z-c++">S</span><span class="z-meta z-group z-c++"><span class="z-punctuation z-section z-group z-begin z-c++">(</span></span></span><span class="z-meta z-function-call z-c++"><span class="z-meta z-group z-c++">M<span class="z-punctuation z-separator z-c++">,</span> <span class="z-meta z-function-call z-c++">std<span class="z-punctuation z-accessor z-double-colon z-c++">::</span><span class="z-variable z-function z-c++">vector</span><span class="z-punctuation z-section z-generic z-begin z-c++">&lt;</span><span class="z-support z-type z-stdint z-c">uint64_t</span><span class="z-punctuation z-section z-generic z-end z-c++">&gt;</span><span class="z-meta z-function-call z-c++"><span class="z-meta z-group z-c++"><span class="z-punctuation z-section z-group z-begin z-c++">(</span></span></span></span><span class="z-meta z-function-call z-c++"><span class="z-meta z-group z-c++">N</span><span class="z-meta z-group z-c++"><span class="z-punctuation z-section z-group z-end z-c++">)</span></span></span></span></span><span class="z-meta z-function-call z-c++"><span class="z-meta z-group z-c++"><span class="z-punctuation z-section z-group z-end z-c++">)</span></span></span><span class="z-punctuation z-separator z-c++">,</span>
</span></span></span></td></tr><tr><td>15</td><td><span class="z-source z-c++"><span class="z-meta z-function z-c++"><span class="z-meta z-block z-c++">        <span class="z-meta z-function-call z-c++"><span class="z-variable z-function z-c++">D</span><span class="z-meta z-group z-c++"><span class="z-punctuation z-section z-group z-begin z-c++">(</span></span></span><span class="z-meta z-function-call z-c++"><span class="z-meta z-group z-c++">M<span class="z-punctuation z-separator z-c++">,</span> <span class="z-meta z-function-call z-c++">std<span class="z-punctuation z-accessor z-double-colon z-c++">::</span><span class="z-variable z-function z-c++">vector</span><span class="z-punctuation z-section z-generic z-begin z-c++">&lt;</span><span class="z-support z-type z-stdint z-c">uint64_t</span><span class="z-punctuation z-section z-generic z-end z-c++">&gt;</span><span class="z-meta z-function-call z-c++"><span class="z-meta z-group z-c++"><span class="z-punctuation z-section z-group z-begin z-c++">(</span></span></span></span><span class="z-meta z-function-call z-c++"><span class="z-meta z-group z-c++">N</span><span class="z-meta z-group z-c++"><span class="z-punctuation z-section z-group z-end z-c++">)</span></span></span></span></span><span class="z-meta z-function-call z-c++"><span class="z-meta z-group z-c++"><span class="z-punctuation z-section z-group z-end z-c++">)</span></span></span><span class="z-punctuation z-terminator z-c++">;</span>
</span></span></span></td></tr><tr><td>16</td><td><span class="z-source z-c++"><span class="z-meta z-function z-c++"><span class="z-meta z-block z-c++">
</span></span></span></td></tr><tr><td>17</td><td><span class="z-source z-c++"><span class="z-meta z-function z-c++"><span class="z-meta z-block z-c++">    <span class="z-keyword z-control z-c++">for</span> <span class="z-meta z-group z-c++"><span class="z-punctuation z-section z-group z-begin z-c++">(</span><span class="z-storage z-type z-c">int</span> i<span class="z-keyword z-operator z-assignment z-c">=</span><span class="z-constant z-numeric z-integer z-decimal z-c++">0</span><span class="z-punctuation z-terminator z-c++">;</span> i<span class="z-keyword z-operator z-comparison z-c">&lt;</span>M<span class="z-punctuation z-terminator z-c++">;</span> i<span class="z-keyword z-operator z-arithmetic z-c">++</span><span class="z-punctuation z-section z-group z-end z-c++">)</span></span>
</span></span></span></td></tr><tr><td>18</td><td><span class="z-source z-c++"><span class="z-meta z-function z-c++"><span class="z-meta z-block z-c++">        <span class="z-keyword z-control z-c++">for</span> <span class="z-meta z-group z-c++"><span class="z-punctuation z-section z-group z-begin z-c++">(</span><span class="z-storage z-type z-c">int</span> j<span class="z-keyword z-operator z-assignment z-c">=</span><span class="z-constant z-numeric z-integer z-decimal z-c++">0</span><span class="z-punctuation z-terminator z-c++">;</span> j<span class="z-keyword z-operator z-comparison z-c">&lt;</span>N<span class="z-punctuation z-terminator z-c++">;</span> j<span class="z-keyword z-operator z-arithmetic z-c">++</span><span class="z-punctuation z-section z-group z-end z-c++">)</span></span>
</span></span></span></td></tr><tr><td>19</td><td><span class="z-source z-c++"><span class="z-meta z-function z-c++"><span class="z-meta z-block z-c++">            std<span class="z-punctuation z-accessor z-double-colon z-c++">::</span>cin <span class="z-keyword z-operator z-arithmetic z-c">&gt;&gt;</span> A<span class="z-meta z-brackets z-c++"><span class="z-punctuation z-section z-brackets z-begin z-c++">[</span>i<span class="z-punctuation z-section z-brackets z-end z-c++">]</span></span><span class="z-meta z-brackets z-c++"><span class="z-punctuation z-section z-brackets z-begin z-c++">[</span>j<span class="z-punctuation z-section z-brackets z-end z-c++">]</span></span><span class="z-punctuation z-terminator z-c++">;</span>
</span></span></span></td></tr><tr><td>20</td><td><span class="z-source z-c++"><span class="z-meta z-function z-c++"><span class="z-meta z-block z-c++">
</span></span></span></td></tr><tr><td>21</td><td><span class="z-source z-c++"><span class="z-meta z-function z-c++"><span class="z-meta z-block z-c++">    <span class="z-keyword z-control z-c++">for</span> <span class="z-meta z-group z-c++"><span class="z-punctuation z-section z-group z-begin z-c++">(</span><span class="z-storage z-type z-c">int</span> i<span class="z-keyword z-operator z-assignment z-c">=</span><span class="z-constant z-numeric z-integer z-decimal z-c++">0</span><span class="z-punctuation z-terminator z-c++">;</span> i<span class="z-keyword z-operator z-comparison z-c">&lt;</span>M<span class="z-punctuation z-terminator z-c++">;</span> i<span class="z-keyword z-operator z-arithmetic z-c">++</span><span class="z-punctuation z-section z-group z-end z-c++">)</span></span>
</span></span></span></td></tr><tr><td>22</td><td><span class="z-source z-c++"><span class="z-meta z-function z-c++"><span class="z-meta z-block z-c++">        <span class="z-keyword z-control z-c++">for</span> <span class="z-meta z-group z-c++"><span class="z-punctuation z-section z-group z-begin z-c++">(</span><span class="z-storage z-type z-c">int</span> j<span class="z-keyword z-operator z-assignment z-c">=</span><span class="z-constant z-numeric z-integer z-decimal z-c++">0</span><span class="z-punctuation z-terminator z-c++">;</span> j<span class="z-keyword z-operator z-comparison z-c">&lt;</span>N<span class="z-punctuation z-terminator z-c++">;</span> j<span class="z-keyword z-operator z-arithmetic z-c">++</span><span class="z-punctuation z-section z-group z-end z-c++">)</span></span> <span class="z-meta z-block z-c++"><span class="z-punctuation z-section z-block z-begin z-c++">{</span>
</span></span></span></span></td></tr><tr><td>23</td><td><span class="z-source z-c++"><span class="z-meta z-function z-c++"><span class="z-meta z-block z-c++"><span class="z-meta z-block z-c++">            S<span class="z-meta z-brackets z-c++"><span class="z-punctuation z-section z-brackets z-begin z-c++">[</span>i<span class="z-punctuation z-section z-brackets z-end z-c++">]</span></span><span class="z-meta z-brackets z-c++"><span class="z-punctuation z-section z-brackets z-begin z-c++">[</span>j<span class="z-punctuation z-section z-brackets z-end z-c++">]</span></span> <span class="z-keyword z-operator z-assignment z-c">=</span> A<span class="z-meta z-brackets z-c++"><span class="z-punctuation z-section z-brackets z-begin z-c++">[</span>i<span class="z-punctuation z-section z-brackets z-end z-c++">]</span></span><span class="z-meta z-brackets z-c++"><span class="z-punctuation z-section z-brackets z-begin z-c++">[</span>j<span class="z-punctuation z-section z-brackets z-end z-c++">]</span></span><span class="z-punctuation z-terminator z-c++">;</span>
</span></span></span></span></td></tr><tr><td>24</td><td><span class="z-source z-c++"><span class="z-meta z-function z-c++"><span class="z-meta z-block z-c++"><span class="z-meta z-block z-c++">
</span></span></span></span></td></tr><tr><td>25</td><td><span class="z-source z-c++"><span class="z-meta z-function z-c++"><span class="z-meta z-block z-c++"><span class="z-meta z-block z-c++">            <span class="z-keyword z-control z-c++">if</span> <span class="z-meta z-group z-c++"><span class="z-punctuation z-section z-group z-begin z-c++">(</span>i <span class="z-keyword z-operator z-comparison z-c">==</span> <span class="z-constant z-numeric z-integer z-decimal z-c++">0</span> <span class="z-keyword z-operator z-arithmetic z-c">&amp;&amp;</span> j <span class="z-keyword z-operator z-comparison z-c">==</span> <span class="z-constant z-numeric z-integer z-decimal z-c++">0</span><span class="z-punctuation z-section z-group z-end z-c++">)</span></span>
</span></span></span></span></td></tr><tr><td>26</td><td><span class="z-source z-c++"><span class="z-meta z-function z-c++"><span class="z-meta z-block z-c++"><span class="z-meta z-block z-c++">                <span class="z-keyword z-control z-flow z-continue z-c++">continue</span><span class="z-punctuation z-terminator z-c++">;</span>
</span></span></span></span></td></tr><tr><td>27</td><td><span class="z-source z-c++"><span class="z-meta z-function z-c++"><span class="z-meta z-block z-c++"><span class="z-meta z-block z-c++">
</span></span></span></span></td></tr><tr><td>28</td><td><span class="z-source z-c++"><span class="z-meta z-function z-c++"><span class="z-meta z-block z-c++"><span class="z-meta z-block z-c++">            <span class="z-keyword z-control z-c++">if</span> <span class="z-meta z-group z-c++"><span class="z-punctuation z-section z-group z-begin z-c++">(</span>i <span class="z-keyword z-operator z-comparison z-c">&gt;</span> <span class="z-constant z-numeric z-integer z-decimal z-c++">0</span><span class="z-punctuation z-section z-group z-end z-c++">)</span></span>
</span></span></span></span></td></tr><tr><td>29</td><td><span class="z-source z-c++"><span class="z-meta z-function z-c++"><span class="z-meta z-block z-c++"><span class="z-meta z-block z-c++">                S<span class="z-meta z-brackets z-c++"><span class="z-punctuation z-section z-brackets z-begin z-c++">[</span>i<span class="z-punctuation z-section z-brackets z-end z-c++">]</span></span><span class="z-meta z-brackets z-c++"><span class="z-punctuation z-section z-brackets z-begin z-c++">[</span>j<span class="z-punctuation z-section z-brackets z-end z-c++">]</span></span> <span class="z-keyword z-operator z-assignment z-augmented z-c">+=</span> S<span class="z-meta z-brackets z-c++"><span class="z-punctuation z-section z-brackets z-begin z-c++">[</span>i<span class="z-keyword z-operator z-arithmetic z-c">-</span><span class="z-constant z-numeric z-integer z-decimal z-c++">1</span><span class="z-punctuation z-section z-brackets z-end z-c++">]</span></span><span class="z-meta z-brackets z-c++"><span class="z-punctuation z-section z-brackets z-begin z-c++">[</span>j<span class="z-punctuation z-section z-brackets z-end z-c++">]</span></span><span class="z-punctuation z-terminator z-c++">;</span>
</span></span></span></span></td></tr><tr><td>30</td><td><span class="z-source z-c++"><span class="z-meta z-function z-c++"><span class="z-meta z-block z-c++"><span class="z-meta z-block z-c++">
</span></span></span></span></td></tr><tr><td>31</td><td><span class="z-source z-c++"><span class="z-meta z-function z-c++"><span class="z-meta z-block z-c++"><span class="z-meta z-block z-c++">            <span class="z-keyword z-control z-c++">if</span> <span class="z-meta z-group z-c++"><span class="z-punctuation z-section z-group z-begin z-c++">(</span>j <span class="z-keyword z-operator z-comparison z-c">&gt;</span> <span class="z-constant z-numeric z-integer z-decimal z-c++">0</span><span class="z-punctuation z-section z-group z-end z-c++">)</span></span>
</span></span></span></span></td></tr><tr><td>32</td><td><span class="z-source z-c++"><span class="z-meta z-function z-c++"><span class="z-meta z-block z-c++"><span class="z-meta z-block z-c++">                S<span class="z-meta z-brackets z-c++"><span class="z-punctuation z-section z-brackets z-begin z-c++">[</span>i<span class="z-punctuation z-section z-brackets z-end z-c++">]</span></span><span class="z-meta z-brackets z-c++"><span class="z-punctuation z-section z-brackets z-begin z-c++">[</span>j<span class="z-punctuation z-section z-brackets z-end z-c++">]</span></span> <span class="z-keyword z-operator z-assignment z-augmented z-c">+=</span> S<span class="z-meta z-brackets z-c++"><span class="z-punctuation z-section z-brackets z-begin z-c++">[</span>i<span class="z-punctuation z-section z-brackets z-end z-c++">]</span></span><span class="z-meta z-brackets z-c++"><span class="z-punctuation z-section z-brackets z-begin z-c++">[</span>j<span class="z-keyword z-operator z-arithmetic z-c">-</span><span class="z-constant z-numeric z-integer z-decimal z-c++">1</span><span class="z-punctuation z-section z-brackets z-end z-c++">]</span></span><span class="z-punctuation z-terminator z-c++">;</span>
</span></span></span></span></td></tr><tr><td>33</td><td><span class="z-source z-c++"><span class="z-meta z-function z-c++"><span class="z-meta z-block z-c++"><span class="z-meta z-block z-c++">
</span></span></span></span></td></tr><tr><td>34</td><td><span class="z-source z-c++"><span class="z-meta z-function z-c++"><span class="z-meta z-block z-c++"><span class="z-meta z-block z-c++">            <span class="z-keyword z-control z-c++">if</span> <span class="z-meta z-group z-c++"><span class="z-punctuation z-section z-group z-begin z-c++">(</span>i <span class="z-keyword z-operator z-comparison z-c">&gt;</span> <span class="z-constant z-numeric z-integer z-decimal z-c++">0</span> <span class="z-keyword z-operator z-arithmetic z-c">&amp;&amp;</span> j <span class="z-keyword z-operator z-comparison z-c">&gt;</span> <span class="z-constant z-numeric z-integer z-decimal z-c++">0</span><span class="z-punctuation z-section z-group z-end z-c++">)</span></span>
</span></span></span></span></td></tr><tr><td>35</td><td><span class="z-source z-c++"><span class="z-meta z-function z-c++"><span class="z-meta z-block z-c++"><span class="z-meta z-block z-c++">                S<span class="z-meta z-brackets z-c++"><span class="z-punctuation z-section z-brackets z-begin z-c++">[</span>i<span class="z-punctuation z-section z-brackets z-end z-c++">]</span></span><span class="z-meta z-brackets z-c++"><span class="z-punctuation z-section z-brackets z-begin z-c++">[</span>j<span class="z-punctuation z-section z-brackets z-end z-c++">]</span></span> <span class="z-keyword z-operator z-assignment z-augmented z-c">-=</span> S<span class="z-meta z-brackets z-c++"><span class="z-punctuation z-section z-brackets z-begin z-c++">[</span>i<span class="z-keyword z-operator z-arithmetic z-c">-</span><span class="z-constant z-numeric z-integer z-decimal z-c++">1</span><span class="z-punctuation z-section z-brackets z-end z-c++">]</span></span><span class="z-meta z-brackets z-c++"><span class="z-punctuation z-section z-brackets z-begin z-c++">[</span>j<span class="z-keyword z-operator z-arithmetic z-c">-</span><span class="z-constant z-numeric z-integer z-decimal z-c++">1</span><span class="z-punctuation z-section z-brackets z-end z-c++">]</span></span><span class="z-punctuation z-terminator z-c++">;</span>
</span></span></span></span></td></tr><tr><td>36</td><td><span class="z-source z-c++"><span class="z-meta z-function z-c++"><span class="z-meta z-block z-c++"><span class="z-meta z-block z-c++">        <span class="z-punctuation z-section z-block z-end z-c++">}</span></span>
</span></span></span></td></tr><tr><td>37</td><td><span class="z-source z-c++"><span class="z-meta z-function z-c++"><span class="z-meta z-block z-c++">
</span></span></span></td></tr><tr><td>38</td><td><span class="z-source z-c++"><span class="z-meta z-function z-c++"><span class="z-meta z-block z-c++">    <span class="z-keyword z-control z-c++">for</span> <span class="z-meta z-group z-c++"><span class="z-punctuation z-section z-group z-begin z-c++">(</span><span class="z-storage z-type z-c">int</span> i<span class="z-keyword z-operator z-assignment z-c">=</span><span class="z-constant z-numeric z-integer z-decimal z-c++">0</span><span class="z-punctuation z-terminator z-c++">;</span> i<span class="z-keyword z-operator z-comparison z-c">&lt;</span>M<span class="z-punctuation z-terminator z-c++">;</span> i<span class="z-keyword z-operator z-arithmetic z-c">++</span><span class="z-punctuation z-section z-group z-end z-c++">)</span></span>
</span></span></span></td></tr><tr><td>39</td><td><span class="z-source z-c++"><span class="z-meta z-function z-c++"><span class="z-meta z-block z-c++">        <span class="z-keyword z-control z-c++">for</span> <span class="z-meta z-group z-c++"><span class="z-punctuation z-section z-group z-begin z-c++">(</span><span class="z-storage z-type z-c">int</span> j<span class="z-keyword z-operator z-assignment z-c">=</span><span class="z-constant z-numeric z-integer z-decimal z-c++">0</span><span class="z-punctuation z-terminator z-c++">;</span> j<span class="z-keyword z-operator z-comparison z-c">&lt;</span>N<span class="z-punctuation z-terminator z-c++">;</span> j<span class="z-keyword z-operator z-arithmetic z-c">++</span><span class="z-punctuation z-section z-group z-end z-c++">)</span></span>
</span></span></span></td></tr><tr><td>40</td><td><span class="z-source z-c++"><span class="z-meta z-function z-c++"><span class="z-meta z-block z-c++">            <span class="z-keyword z-control z-c++">if</span> <span class="z-meta z-group z-c++"><span class="z-punctuation z-section z-group z-begin z-c++">(</span>A<span class="z-meta z-brackets z-c++"><span class="z-punctuation z-section z-brackets z-begin z-c++">[</span>i<span class="z-punctuation z-section z-brackets z-end z-c++">]</span></span><span class="z-meta z-brackets z-c++"><span class="z-punctuation z-section z-brackets z-begin z-c++">[</span>j<span class="z-punctuation z-section z-brackets z-end z-c++">]</span></span> <span class="z-keyword z-operator z-comparison z-c">==</span> <span class="z-constant z-numeric z-integer z-decimal z-c++">0</span><span class="z-punctuation z-section z-group z-end z-c++">)</span></span>
</span></span></span></td></tr><tr><td>41</td><td><span class="z-source z-c++"><span class="z-meta z-function z-c++"><span class="z-meta z-block z-c++">                D<span class="z-meta z-brackets z-c++"><span class="z-punctuation z-section z-brackets z-begin z-c++">[</span>i<span class="z-punctuation z-section z-brackets z-end z-c++">]</span></span><span class="z-meta z-brackets z-c++"><span class="z-punctuation z-section z-brackets z-begin z-c++">[</span>j<span class="z-punctuation z-section z-brackets z-end z-c++">]</span></span> <span class="z-keyword z-operator z-assignment z-c">=</span> <span class="z-constant z-numeric z-integer z-decimal z-c++">0</span><span class="z-punctuation z-terminator z-c++">;</span>
</span></span></span></td></tr><tr><td>42</td><td><span class="z-source z-c++"><span class="z-meta z-function z-c++"><span class="z-meta z-block z-c++">            <span class="z-keyword z-control z-c++">else</span> <span class="z-meta z-block z-c++"><span class="z-punctuation z-section z-block z-begin z-c++">{</span>
</span></span></span></span></td></tr><tr><td>43</td><td><span class="z-source z-c++"><span class="z-meta z-function z-c++"><span class="z-meta z-block z-c++"><span class="z-meta z-block z-c++">                D<span class="z-meta z-brackets z-c++"><span class="z-punctuation z-section z-brackets z-begin z-c++">[</span>i<span class="z-punctuation z-section z-brackets z-end z-c++">]</span></span><span class="z-meta z-brackets z-c++"><span class="z-punctuation z-section z-brackets z-begin z-c++">[</span>j<span class="z-punctuation z-section z-brackets z-end z-c++">]</span></span> <span class="z-keyword z-operator z-assignment z-c">=</span> <span class="z-constant z-numeric z-integer z-decimal z-c++">1</span><span class="z-punctuation z-terminator z-c++">;</span>
</span></span></span></span></td></tr><tr><td>44</td><td><span class="z-source z-c++"><span class="z-meta z-function z-c++"><span class="z-meta z-block z-c++"><span class="z-meta z-block z-c++">
</span></span></span></span></td></tr><tr><td>45</td><td><span class="z-source z-c++"><span class="z-meta z-function z-c++"><span class="z-meta z-block z-c++"><span class="z-meta z-block z-c++">                <span class="z-keyword z-control z-c++">if</span> <span class="z-meta z-group z-c++"><span class="z-punctuation z-section z-group z-begin z-c++">(</span>i <span class="z-keyword z-operator z-comparison z-c">==</span> <span class="z-constant z-numeric z-integer z-decimal z-c++">0</span> <span class="z-keyword z-operator z-arithmetic z-c">||</span> j <span class="z-keyword z-operator z-comparison z-c">==</span> <span class="z-constant z-numeric z-integer z-decimal z-c++">0</span><span class="z-punctuation z-section z-group z-end z-c++">)</span></span>
</span></span></span></span></td></tr><tr><td>46</td><td><span class="z-source z-c++"><span class="z-meta z-function z-c++"><span class="z-meta z-block z-c++"><span class="z-meta z-block z-c++">                    <span class="z-keyword z-control z-flow z-continue z-c++">continue</span><span class="z-punctuation z-terminator z-c++">;</span>
</span></span></span></span></td></tr><tr><td>47</td><td><span class="z-source z-c++"><span class="z-meta z-function z-c++"><span class="z-meta z-block z-c++"><span class="z-meta z-block z-c++">
</span></span></span></span></td></tr><tr><td>48</td><td><span class="z-source z-c++"><span class="z-meta z-function z-c++"><span class="z-meta z-block z-c++"><span class="z-meta z-block z-c++">                D<span class="z-meta z-brackets z-c++"><span class="z-punctuation z-section z-brackets z-begin z-c++">[</span>i<span class="z-punctuation z-section z-brackets z-end z-c++">]</span></span><span class="z-meta z-brackets z-c++"><span class="z-punctuation z-section z-brackets z-begin z-c++">[</span>j<span class="z-punctuation z-section z-brackets z-end z-c++">]</span></span> <span class="z-keyword z-operator z-assignment z-augmented z-c">+=</span> <span class="z-meta z-function-call z-c++">std<span class="z-punctuation z-accessor z-double-colon z-c++">::</span><span class="z-variable z-function z-c++">min</span><span class="z-meta z-group z-c++"><span class="z-punctuation z-section z-group z-begin z-c++">(</span></span></span><span class="z-meta z-function-call z-c++"><span class="z-meta z-group z-c++"><span class="z-meta z-block z-c++"><span class="z-punctuation z-section z-block z-begin z-c++">{</span>D<span class="z-meta z-brackets z-c++"><span class="z-punctuation z-section z-brackets z-begin z-c++">[</span>i<span class="z-keyword z-operator z-arithmetic z-c">-</span><span class="z-constant z-numeric z-integer z-decimal z-c++">1</span><span class="z-punctuation z-section z-brackets z-end z-c++">]</span></span><span class="z-meta z-brackets z-c++"><span class="z-punctuation z-section z-brackets z-begin z-c++">[</span>j<span class="z-punctuation z-section z-brackets z-end z-c++">]</span></span><span class="z-punctuation z-separator z-c++">,</span> D<span class="z-meta z-brackets z-c++"><span class="z-punctuation z-section z-brackets z-begin z-c++">[</span>i<span class="z-punctuation z-section z-brackets z-end z-c++">]</span></span><span class="z-meta z-brackets z-c++"><span class="z-punctuation z-section z-brackets z-begin z-c++">[</span>j<span class="z-keyword z-operator z-arithmetic z-c">-</span><span class="z-constant z-numeric z-integer z-decimal z-c++">1</span><span class="z-punctuation z-section z-brackets z-end z-c++">]</span></span><span class="z-punctuation z-separator z-c++">,</span> D<span class="z-meta z-brackets z-c++"><span class="z-punctuation z-section z-brackets z-begin z-c++">[</span>i<span class="z-keyword z-operator z-arithmetic z-c">-</span><span class="z-constant z-numeric z-integer z-decimal z-c++">1</span><span class="z-punctuation z-section z-brackets z-end z-c++">]</span></span><span class="z-meta z-brackets z-c++"><span class="z-punctuation z-section z-brackets z-begin z-c++">[</span>j<span class="z-keyword z-operator z-arithmetic z-c">-</span><span class="z-constant z-numeric z-integer z-decimal z-c++">1</span><span class="z-punctuation z-section z-brackets z-end z-c++">]</span></span><span class="z-punctuation z-section z-block z-end z-c++">}</span></span></span></span><span class="z-meta z-function-call z-c++"><span class="z-meta z-group z-c++"><span class="z-punctuation z-section z-group z-end z-c++">)</span></span></span><span class="z-punctuation z-terminator z-c++">;</span>
</span></span></span></span></td></tr><tr><td>49</td><td><span class="z-source z-c++"><span class="z-meta z-function z-c++"><span class="z-meta z-block z-c++"><span class="z-meta z-block z-c++">            <span class="z-punctuation z-section z-block z-end z-c++">}</span></span>
</span></span></span></td></tr><tr><td>50</td><td><span class="z-source z-c++"><span class="z-meta z-function z-c++"><span class="z-meta z-block z-c++">
</span></span></span></td></tr><tr><td>51</td><td><span class="z-source z-c++"><span class="z-meta z-function z-c++"><span class="z-meta z-block z-c++">    <span class="z-support z-type z-stdint z-c">uint64_t</span> maxSum <span class="z-keyword z-operator z-assignment z-c">=</span> <span class="z-constant z-numeric z-integer z-decimal z-c++">0</span><span class="z-punctuation z-terminator z-c++">;</span>
</span></span></span></td></tr><tr><td>52</td><td><span class="z-source z-c++"><span class="z-meta z-function z-c++"><span class="z-meta z-block z-c++">    <span class="z-storage z-type z-c">int</span> maxI <span class="z-keyword z-operator z-assignment z-c">=</span> <span class="z-keyword z-operator z-arithmetic z-c">-</span><span class="z-constant z-numeric z-integer z-decimal z-c++">1</span><span class="z-punctuation z-separator z-c++">,</span> maxJ <span class="z-keyword z-operator z-assignment z-c">=</span> <span class="z-keyword z-operator z-arithmetic z-c">-</span><span class="z-constant z-numeric z-integer z-decimal z-c++">1</span><span class="z-punctuation z-terminator z-c++">;</span>
</span></span></span></td></tr><tr><td>53</td><td><span class="z-source z-c++"><span class="z-meta z-function z-c++"><span class="z-meta z-block z-c++">
</span></span></span></td></tr><tr><td>54</td><td><span class="z-source z-c++"><span class="z-meta z-function z-c++"><span class="z-meta z-block z-c++">    <span class="z-keyword z-control z-c++">for</span> <span class="z-meta z-group z-c++"><span class="z-punctuation z-section z-group z-begin z-c++">(</span><span class="z-storage z-type z-c">int</span> i<span class="z-keyword z-operator z-assignment z-c">=</span><span class="z-constant z-numeric z-integer z-decimal z-c++">0</span><span class="z-punctuation z-terminator z-c++">;</span> i<span class="z-keyword z-operator z-comparison z-c">&lt;</span>M<span class="z-punctuation z-terminator z-c++">;</span> i<span class="z-keyword z-operator z-arithmetic z-c">++</span><span class="z-punctuation z-section z-group z-end z-c++">)</span></span>
</span></span></span></td></tr><tr><td>55</td><td><span class="z-source z-c++"><span class="z-meta z-function z-c++"><span class="z-meta z-block z-c++">        <span class="z-keyword z-control z-c++">for</span> <span class="z-meta z-group z-c++"><span class="z-punctuation z-section z-group z-begin z-c++">(</span><span class="z-storage z-type z-c">int</span> j<span class="z-keyword z-operator z-assignment z-c">=</span><span class="z-constant z-numeric z-integer z-decimal z-c++">0</span><span class="z-punctuation z-terminator z-c++">;</span> j<span class="z-keyword z-operator z-comparison z-c">&lt;</span>N<span class="z-punctuation z-terminator z-c++">;</span> j<span class="z-keyword z-operator z-arithmetic z-c">++</span><span class="z-punctuation z-section z-group z-end z-c++">)</span></span> <span class="z-meta z-block z-c++"><span class="z-punctuation z-section z-block z-begin z-c++">{</span>
</span></span></span></span></td></tr><tr><td>56</td><td><span class="z-source z-c++"><span class="z-meta z-function z-c++"><span class="z-meta z-block z-c++"><span class="z-meta z-block z-c++">            <span class="z-comment z-line z-double-slash z-c"><span class="z-punctuation z-definition z-comment z-c">//</span> Coordinates of *the upper left neighbor* of the upper left corner
</span></span></span></span></span></td></tr><tr><td>57</td><td><span class="z-source z-c++"><span class="z-meta z-function z-c++"><span class="z-meta z-block z-c++"><span class="z-meta z-block z-c++">            <span class="z-comment z-line z-double-slash z-c"><span class="z-punctuation z-definition z-comment z-c">//</span> of the widest nonzero contiguous square submatrix with a lower
</span></span></span></span></span></td></tr><tr><td>58</td><td><span class="z-source z-c++"><span class="z-meta z-function z-c++"><span class="z-meta z-block z-c++"><span class="z-meta z-block z-c++">            <span class="z-comment z-line z-double-slash z-c"><span class="z-punctuation z-definition z-comment z-c">//</span> right corner at (i,j)
</span></span></span></span></span></td></tr><tr><td>59</td><td><span class="z-source z-c++"><span class="z-meta z-function z-c++"><span class="z-meta z-block z-c++"><span class="z-meta z-block z-c++">            <span class="z-storage z-type z-c">int</span> ul_i <span class="z-keyword z-operator z-assignment z-c">=</span> i <span class="z-keyword z-operator z-arithmetic z-c">-</span> D<span class="z-meta z-brackets z-c++"><span class="z-punctuation z-section z-brackets z-begin z-c++">[</span>i<span class="z-punctuation z-section z-brackets z-end z-c++">]</span></span><span class="z-meta z-brackets z-c++"><span class="z-punctuation z-section z-brackets z-begin z-c++">[</span>j<span class="z-punctuation z-section z-brackets z-end z-c++">]</span></span><span class="z-punctuation z-terminator z-c++">;</span>
</span></span></span></span></td></tr><tr><td>60</td><td><span class="z-source z-c++"><span class="z-meta z-function z-c++"><span class="z-meta z-block z-c++"><span class="z-meta z-block z-c++">            <span class="z-storage z-type z-c">int</span> ul_j <span class="z-keyword z-operator z-assignment z-c">=</span> j <span class="z-keyword z-operator z-arithmetic z-c">-</span> D<span class="z-meta z-brackets z-c++"><span class="z-punctuation z-section z-brackets z-begin z-c++">[</span>i<span class="z-punctuation z-section z-brackets z-end z-c++">]</span></span><span class="z-meta z-brackets z-c++"><span class="z-punctuation z-section z-brackets z-begin z-c++">[</span>j<span class="z-punctuation z-section z-brackets z-end z-c++">]</span></span><span class="z-punctuation z-terminator z-c++">;</span>
</span></span></span></span></td></tr><tr><td>61</td><td><span class="z-source z-c++"><span class="z-meta z-function z-c++"><span class="z-meta z-block z-c++"><span class="z-meta z-block z-c++">
</span></span></span></span></td></tr><tr><td>62</td><td><span class="z-source z-c++"><span class="z-meta z-function z-c++"><span class="z-meta z-block z-c++"><span class="z-meta z-block z-c++">            <span class="z-support z-type z-stdint z-c">uint64_t</span> sum <span class="z-keyword z-operator z-assignment z-c">=</span> S<span class="z-meta z-brackets z-c++"><span class="z-punctuation z-section z-brackets z-begin z-c++">[</span>i<span class="z-punctuation z-section z-brackets z-end z-c++">]</span></span><span class="z-meta z-brackets z-c++"><span class="z-punctuation z-section z-brackets z-begin z-c++">[</span>j<span class="z-punctuation z-section z-brackets z-end z-c++">]</span></span><span class="z-punctuation z-terminator z-c++">;</span>
</span></span></span></span></td></tr><tr><td>63</td><td><span class="z-source z-c++"><span class="z-meta z-function z-c++"><span class="z-meta z-block z-c++"><span class="z-meta z-block z-c++">
</span></span></span></span></td></tr><tr><td>64</td><td><span class="z-source z-c++"><span class="z-meta z-function z-c++"><span class="z-meta z-block z-c++"><span class="z-meta z-block z-c++">            <span class="z-keyword z-control z-c++">if</span> <span class="z-meta z-group z-c++"><span class="z-punctuation z-section z-group z-begin z-c++">(</span>ul_i <span class="z-keyword z-operator z-comparison z-c">&gt;=</span> <span class="z-constant z-numeric z-integer z-decimal z-c++">0</span><span class="z-punctuation z-section z-group z-end z-c++">)</span></span>
</span></span></span></span></td></tr><tr><td>65</td><td><span class="z-source z-c++"><span class="z-meta z-function z-c++"><span class="z-meta z-block z-c++"><span class="z-meta z-block z-c++">                sum <span class="z-keyword z-operator z-assignment z-augmented z-c">-=</span> S<span class="z-meta z-brackets z-c++"><span class="z-punctuation z-section z-brackets z-begin z-c++">[</span>ul_i<span class="z-punctuation z-section z-brackets z-end z-c++">]</span></span><span class="z-meta z-brackets z-c++"><span class="z-punctuation z-section z-brackets z-begin z-c++">[</span>j<span class="z-punctuation z-section z-brackets z-end z-c++">]</span></span><span class="z-punctuation z-terminator z-c++">;</span>
</span></span></span></span></td></tr><tr><td>66</td><td><span class="z-source z-c++"><span class="z-meta z-function z-c++"><span class="z-meta z-block z-c++"><span class="z-meta z-block z-c++">
</span></span></span></span></td></tr><tr><td>67</td><td><span class="z-source z-c++"><span class="z-meta z-function z-c++"><span class="z-meta z-block z-c++"><span class="z-meta z-block z-c++">            <span class="z-keyword z-control z-c++">if</span> <span class="z-meta z-group z-c++"><span class="z-punctuation z-section z-group z-begin z-c++">(</span>ul_j <span class="z-keyword z-operator z-comparison z-c">&gt;=</span> <span class="z-constant z-numeric z-integer z-decimal z-c++">0</span><span class="z-punctuation z-section z-group z-end z-c++">)</span></span>
</span></span></span></span></td></tr><tr><td>68</td><td><span class="z-source z-c++"><span class="z-meta z-function z-c++"><span class="z-meta z-block z-c++"><span class="z-meta z-block z-c++">                sum <span class="z-keyword z-operator z-assignment z-augmented z-c">-=</span> S<span class="z-meta z-brackets z-c++"><span class="z-punctuation z-section z-brackets z-begin z-c++">[</span>i<span class="z-punctuation z-section z-brackets z-end z-c++">]</span></span><span class="z-meta z-brackets z-c++"><span class="z-punctuation z-section z-brackets z-begin z-c++">[</span>ul_j<span class="z-punctuation z-section z-brackets z-end z-c++">]</span></span><span class="z-punctuation z-terminator z-c++">;</span>
</span></span></span></span></td></tr><tr><td>69</td><td><span class="z-source z-c++"><span class="z-meta z-function z-c++"><span class="z-meta z-block z-c++"><span class="z-meta z-block z-c++">
</span></span></span></span></td></tr><tr><td>70</td><td><span class="z-source z-c++"><span class="z-meta z-function z-c++"><span class="z-meta z-block z-c++"><span class="z-meta z-block z-c++">            <span class="z-keyword z-control z-c++">if</span> <span class="z-meta z-group z-c++"><span class="z-punctuation z-section z-group z-begin z-c++">(</span>ul_i <span class="z-keyword z-operator z-comparison z-c">&gt;=</span> <span class="z-constant z-numeric z-integer z-decimal z-c++">0</span> <span class="z-keyword z-operator z-arithmetic z-c">&amp;&amp;</span> ul_j <span class="z-keyword z-operator z-comparison z-c">&gt;=</span> <span class="z-constant z-numeric z-integer z-decimal z-c++">0</span><span class="z-punctuation z-section z-group z-end z-c++">)</span></span>
</span></span></span></span></td></tr><tr><td>71</td><td><span class="z-source z-c++"><span class="z-meta z-function z-c++"><span class="z-meta z-block z-c++"><span class="z-meta z-block z-c++">                sum <span class="z-keyword z-operator z-assignment z-augmented z-c">+=</span> S<span class="z-meta z-brackets z-c++"><span class="z-punctuation z-section z-brackets z-begin z-c++">[</span>ul_i<span class="z-punctuation z-section z-brackets z-end z-c++">]</span></span><span class="z-meta z-brackets z-c++"><span class="z-punctuation z-section z-brackets z-begin z-c++">[</span>ul_j<span class="z-punctuation z-section z-brackets z-end z-c++">]</span></span><span class="z-punctuation z-terminator z-c++">;</span>
</span></span></span></span></td></tr><tr><td>72</td><td><span class="z-source z-c++"><span class="z-meta z-function z-c++"><span class="z-meta z-block z-c++"><span class="z-meta z-block z-c++">
</span></span></span></span></td></tr><tr><td>73</td><td><span class="z-source z-c++"><span class="z-meta z-function z-c++"><span class="z-meta z-block z-c++"><span class="z-meta z-block z-c++">            <span class="z-keyword z-control z-c++">if</span> <span class="z-meta z-group z-c++"><span class="z-punctuation z-section z-group z-begin z-c++">(</span>sum <span class="z-keyword z-operator z-comparison z-c">&gt;</span> maxSum<span class="z-punctuation z-section z-group z-end z-c++">)</span></span> <span class="z-meta z-block z-c++"><span class="z-punctuation z-section z-block z-begin z-c++">{</span>
</span></span></span></span></span></td></tr><tr><td>74</td><td><span class="z-source z-c++"><span class="z-meta z-function z-c++"><span class="z-meta z-block z-c++"><span class="z-meta z-block z-c++"><span class="z-meta z-block z-c++">                maxSum <span class="z-keyword z-operator z-assignment z-c">=</span> sum<span class="z-punctuation z-terminator z-c++">;</span>
</span></span></span></span></span></td></tr><tr><td>75</td><td><span class="z-source z-c++"><span class="z-meta z-function z-c++"><span class="z-meta z-block z-c++"><span class="z-meta z-block z-c++"><span class="z-meta z-block z-c++">                maxI <span class="z-keyword z-operator z-assignment z-c">=</span> i<span class="z-punctuation z-terminator z-c++">;</span>
</span></span></span></span></span></td></tr><tr><td>76</td><td><span class="z-source z-c++"><span class="z-meta z-function z-c++"><span class="z-meta z-block z-c++"><span class="z-meta z-block z-c++"><span class="z-meta z-block z-c++">                maxJ <span class="z-keyword z-operator z-assignment z-c">=</span> j<span class="z-punctuation z-terminator z-c++">;</span>
</span></span></span></span></span></td></tr><tr><td>77</td><td><span class="z-source z-c++"><span class="z-meta z-function z-c++"><span class="z-meta z-block z-c++"><span class="z-meta z-block z-c++"><span class="z-meta z-block z-c++">            <span class="z-punctuation z-section z-block z-end z-c++">}</span></span>
</span></span></span></span></td></tr><tr><td>78</td><td><span class="z-source z-c++"><span class="z-meta z-function z-c++"><span class="z-meta z-block z-c++"><span class="z-meta z-block z-c++">        <span class="z-punctuation z-section z-block z-end z-c++">}</span></span>
</span></span></span></td></tr><tr><td>79</td><td><span class="z-source z-c++"><span class="z-meta z-function z-c++"><span class="z-meta z-block z-c++">
</span></span></span></td></tr><tr><td>80</td><td><span class="z-source z-c++"><span class="z-meta z-function z-c++"><span class="z-meta z-block z-c++">    std<span class="z-punctuation z-accessor z-double-colon z-c++">::</span>cout <span class="z-keyword z-operator z-arithmetic z-c">&lt;&lt;</span> <span class="z-meta z-function-call z-c++">std<span class="z-punctuation z-accessor z-double-colon z-c++">::</span><span class="z-variable z-function z-c++">format</span><span class="z-meta z-group z-c++"><span class="z-punctuation z-section z-group z-begin z-c++">(</span></span></span><span class="z-meta z-function-call z-c++"><span class="z-meta z-group z-c++"><span class="z-string z-quoted z-double z-c"><span class="z-punctuation z-definition z-string z-begin z-c">&quot;</span>Sum={} in {}-wide square starting at ({},{})<span class="z-constant z-character z-escape z-c">\n</span><span class="z-punctuation z-definition z-string z-end z-c">&quot;</span></span><span class="z-punctuation z-separator z-c++">,</span>
</span></span></span></span></span></td></tr><tr><td>81</td><td><span class="z-source z-c++"><span class="z-meta z-function z-c++"><span class="z-meta z-block z-c++"><span class="z-meta z-function-call z-c++"><span class="z-meta z-group z-c++">        maxSum<span class="z-punctuation z-separator z-c++">,</span>
</span></span></span></span></span></td></tr><tr><td>82</td><td><span class="z-source z-c++"><span class="z-meta z-function z-c++"><span class="z-meta z-block z-c++"><span class="z-meta z-function-call z-c++"><span class="z-meta z-group z-c++">        D<span class="z-meta z-brackets z-c++"><span class="z-punctuation z-section z-brackets z-begin z-c++">[</span>maxI<span class="z-punctuation z-section z-brackets z-end z-c++">]</span></span><span class="z-meta z-brackets z-c++"><span class="z-punctuation z-section z-brackets z-begin z-c++">[</span>maxJ<span class="z-punctuation z-section z-brackets z-end z-c++">]</span></span><span class="z-punctuation z-separator z-c++">,</span>
</span></span></span></span></span></td></tr><tr><td>83</td><td><span class="z-source z-c++"><span class="z-meta z-function z-c++"><span class="z-meta z-block z-c++"><span class="z-meta z-function-call z-c++"><span class="z-meta z-group z-c++">        maxI <span class="z-keyword z-operator z-arithmetic z-c">-</span> D<span class="z-meta z-brackets z-c++"><span class="z-punctuation z-section z-brackets z-begin z-c++">[</span>maxI<span class="z-punctuation z-section z-brackets z-end z-c++">]</span></span><span class="z-meta z-brackets z-c++"><span class="z-punctuation z-section z-brackets z-begin z-c++">[</span>maxJ<span class="z-punctuation z-section z-brackets z-end z-c++">]</span></span> <span class="z-keyword z-operator z-arithmetic z-c">+</span> <span class="z-constant z-numeric z-integer z-decimal z-c++">1</span><span class="z-punctuation z-separator z-c++">,</span>
</span></span></span></span></span></td></tr><tr><td>84</td><td><span class="z-source z-c++"><span class="z-meta z-function z-c++"><span class="z-meta z-block z-c++"><span class="z-meta z-function-call z-c++"><span class="z-meta z-group z-c++">        maxJ <span class="z-keyword z-operator z-arithmetic z-c">-</span> D<span class="z-meta z-brackets z-c++"><span class="z-punctuation z-section z-brackets z-begin z-c++">[</span>maxI<span class="z-punctuation z-section z-brackets z-end z-c++">]</span></span><span class="z-meta z-brackets z-c++"><span class="z-punctuation z-section z-brackets z-begin z-c++">[</span>maxJ<span class="z-punctuation z-section z-brackets z-end z-c++">]</span></span> <span class="z-keyword z-operator z-arithmetic z-c">+</span> <span class="z-constant z-numeric z-integer z-decimal z-c++">1</span></span></span><span class="z-meta z-function-call z-c++"><span class="z-meta z-group z-c++"><span class="z-punctuation z-section z-group z-end z-c++">)</span></span></span><span class="z-punctuation z-terminator z-c++">;</span>
</span></span></span></td></tr><tr><td>85</td><td><span class="z-source z-c++"><span class="z-meta z-function z-c++"><span class="z-meta z-block z-c++"></span></span><span class="z-meta z-function z-c++"><span class="z-meta z-block z-c++"><span class="z-punctuation z-section z-block z-end z-c++">}</span></span></span>
</span></td></tr></tbody></table></code></pre>
<p>Which outputs the correct result for the <a href="https://orthogonalscribe.github.io/max-submatrix/#example">example</a>:</p>
<pre data-lang="sh" class="language-sh z-code"><code class="language-sh" data-lang="sh"><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">$</span></span><span class="z-meta z-function-call z-arguments z-shell"> c++<span class="z-variable z-parameter z-option z-shell"><span class="z-punctuation z-definition z-parameter z-shell"> --</span>std</span><span class="z-keyword z-operator z-assignment z-option z-shell">=</span>c++20 max-submatrix.cpp</span> <span class="z-keyword z-operator z-logical z-and z-shell">&amp;&amp;</span> <span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">./a.out</span></span><span class="z-meta z-function-call z-arguments z-shell"> <span class="z-keyword z-operator z-assignment z-redirection z-shell">&lt;</span> input.txt</span>
</span><span class="z-source z-shell z-bash"><span class="z-variable z-other z-readwrite z-assignment z-shell">Sum</span><span class="z-keyword z-operator z-assignment z-shell">=</span><span class="z-string z-unquoted z-shell">1209</span> <span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">in</span></span><span class="z-meta z-function-call z-arguments z-shell"> 5-wide square starting at (3,4</span><span class="z-meta z-function-call z-shell"></span>)
</span></code></pre>
<h2 id="helper-scripts">Helper scripts</h2>
<ol>
<li>We use <a href="https://orthogonalscribe.github.io/max-submatrix/gen_input.py"><code>gen_input.py</code></a> to generate reproducible input data that fits the problem constraints:</li>
</ol>
<pre data-linenos data-lang="py" class="language-py z-code"><code class="language-py" data-lang="py"><table><tbody><tr><td>1</td><td><span class="z-source z-python"><span class="z-comment z-line z-number-sign z-python"><span class="z-punctuation z-definition z-comment z-python">#</span>!/usr/bin/env python3
</span></span></td></tr><tr><td>2</td><td><span class="z-source z-python">
</span></td></tr><tr><td>3</td><td><span class="z-source z-python"><span class="z-meta z-statement z-import z-python"><span class="z-keyword z-control z-import z-python">import</span> <span class="z-meta z-qualified-name z-python"><span class="z-meta z-generic-name z-python">argparse</span></span></span>
</span></td></tr><tr><td>4</td><td><span class="z-source z-python"><span class="z-meta z-statement z-import z-python"><span class="z-keyword z-control z-import z-python">import</span> <span class="z-meta z-qualified-name z-python"><span class="z-meta z-generic-name z-python">random</span></span></span>
</span></td></tr><tr><td>5</td><td><span class="z-source z-python"><span class="z-meta z-statement z-import z-python"><span class="z-keyword z-control z-import z-python">import</span> <span class="z-meta z-qualified-name z-python"><span class="z-meta z-generic-name z-python">sys</span></span></span>
</span></td></tr><tr><td>6</td><td><span class="z-source z-python">
</span></td></tr><tr><td>7</td><td><span class="z-source z-python"><span class="z-meta z-qualified-name z-python"><span class="z-meta z-generic-name z-python">parser</span></span> <span class="z-keyword z-operator z-assignment z-python">=</span> <span class="z-meta z-function-call z-python"><span class="z-meta z-qualified-name z-python"><span class="z-meta z-generic-name z-python">argparse</span></span><span class="z-meta z-qualified-name z-python"><span class="z-punctuation z-accessor z-dot z-python">.</span></span><span class="z-meta z-qualified-name z-python"><span class="z-variable z-function z-python"><span class="z-meta z-generic-name z-python">ArgumentParser</span></span></span></span><span class="z-meta z-function-call z-arguments z-python"><span class="z-punctuation z-section z-arguments z-begin z-python">(</span>
</span></span></td></tr><tr><td>8</td><td><span class="z-source z-python"><span class="z-meta z-function-call z-arguments z-python">    <span class="z-variable z-parameter z-python">description</span><span class="z-keyword z-operator z-assignment z-python">=</span><span class="z-meta z-string z-python"><span class="z-string z-quoted z-single z-python"><span class="z-punctuation z-definition z-string z-begin z-python">&#39;</span></span></span><span class="z-meta z-string z-python"><span class="z-string z-quoted z-single z-python">Input generator for the maximum NzCSS problem<span class="z-punctuation z-definition z-string z-end z-python">&#39;</span></span></span><span class="z-punctuation z-section z-arguments z-end z-python">)</span></span>
</span></td></tr><tr><td>9</td><td><span class="z-source z-python">
</span></td></tr><tr><td>10</td><td><span class="z-source z-python"><span class="z-meta z-function-call z-python"><span class="z-meta z-qualified-name z-python"><span class="z-meta z-generic-name z-python">parser</span></span><span class="z-meta z-qualified-name z-python"><span class="z-punctuation z-accessor z-dot z-python">.</span></span><span class="z-meta z-qualified-name z-python"><span class="z-variable z-function z-python"><span class="z-meta z-generic-name z-python">add_argument</span></span></span></span><span class="z-meta z-function-call z-arguments z-python"><span class="z-punctuation z-section z-arguments z-begin z-python">(</span><span class="z-meta z-string z-python"><span class="z-string z-quoted z-single z-python"><span class="z-punctuation z-definition z-string z-begin z-python">&#39;</span></span></span><span class="z-meta z-string z-python"><span class="z-string z-quoted z-single z-python">M<span class="z-punctuation z-definition z-string z-end z-python">&#39;</span></span></span><span class="z-punctuation z-separator z-arguments z-python">,</span> <span class="z-variable z-parameter z-python">type</span><span class="z-keyword z-operator z-assignment z-python">=</span><span class="z-meta z-qualified-name z-python"><span class="z-support z-type z-python">int</span></span><span class="z-punctuation z-separator z-arguments z-python">,</span> <span class="z-variable z-parameter z-python">help</span><span class="z-keyword z-operator z-assignment z-python">=</span><span class="z-meta z-string z-python"><span class="z-string z-quoted z-single z-python"><span class="z-punctuation z-definition z-string z-begin z-python">&#39;</span></span></span><span class="z-meta z-string z-python"><span class="z-string z-quoted z-single z-python">Number of rows of the input matrix<span class="z-punctuation z-definition z-string z-end z-python">&#39;</span></span></span><span class="z-punctuation z-section z-arguments z-end z-python">)</span></span>
</span></td></tr><tr><td>11</td><td><span class="z-source z-python"><span class="z-meta z-function-call z-python"><span class="z-meta z-qualified-name z-python"><span class="z-meta z-generic-name z-python">parser</span></span><span class="z-meta z-qualified-name z-python"><span class="z-punctuation z-accessor z-dot z-python">.</span></span><span class="z-meta z-qualified-name z-python"><span class="z-variable z-function z-python"><span class="z-meta z-generic-name z-python">add_argument</span></span></span></span><span class="z-meta z-function-call z-arguments z-python"><span class="z-punctuation z-section z-arguments z-begin z-python">(</span><span class="z-meta z-string z-python"><span class="z-string z-quoted z-single z-python"><span class="z-punctuation z-definition z-string z-begin z-python">&#39;</span></span></span><span class="z-meta z-string z-python"><span class="z-string z-quoted z-single z-python">N<span class="z-punctuation z-definition z-string z-end z-python">&#39;</span></span></span><span class="z-punctuation z-separator z-arguments z-python">,</span> <span class="z-variable z-parameter z-python">type</span><span class="z-keyword z-operator z-assignment z-python">=</span><span class="z-meta z-qualified-name z-python"><span class="z-support z-type z-python">int</span></span><span class="z-punctuation z-separator z-arguments z-python">,</span> <span class="z-variable z-parameter z-python">help</span><span class="z-keyword z-operator z-assignment z-python">=</span><span class="z-meta z-string z-python"><span class="z-string z-quoted z-single z-python"><span class="z-punctuation z-definition z-string z-begin z-python">&#39;</span></span></span><span class="z-meta z-string z-python"><span class="z-string z-quoted z-single z-python">Number of columns of the input matrix<span class="z-punctuation z-definition z-string z-end z-python">&#39;</span></span></span><span class="z-punctuation z-section z-arguments z-end z-python">)</span></span>
</span></td></tr><tr><td>12</td><td><span class="z-source z-python"><span class="z-meta z-function-call z-python"><span class="z-meta z-qualified-name z-python"><span class="z-meta z-generic-name z-python">parser</span></span><span class="z-meta z-qualified-name z-python"><span class="z-punctuation z-accessor z-dot z-python">.</span></span><span class="z-meta z-qualified-name z-python"><span class="z-variable z-function z-python"><span class="z-meta z-generic-name z-python">add_argument</span></span></span></span><span class="z-meta z-function-call z-arguments z-python"><span class="z-punctuation z-section z-arguments z-begin z-python">(</span><span class="z-meta z-string z-python"><span class="z-string z-quoted z-single z-python"><span class="z-punctuation z-definition z-string z-begin z-python">&#39;</span></span></span><span class="z-meta z-string z-python"><span class="z-string z-quoted z-single z-python">seed<span class="z-punctuation z-definition z-string z-end z-python">&#39;</span></span></span><span class="z-punctuation z-separator z-arguments z-python">,</span> <span class="z-variable z-parameter z-python">type</span><span class="z-keyword z-operator z-assignment z-python">=</span><span class="z-meta z-qualified-name z-python"><span class="z-support z-type z-python">int</span></span><span class="z-punctuation z-separator z-arguments z-python">,</span> <span class="z-variable z-parameter z-python">help</span><span class="z-keyword z-operator z-assignment z-python">=</span><span class="z-meta z-string z-python"><span class="z-string z-quoted z-single z-python"><span class="z-punctuation z-definition z-string z-begin z-python">&#39;</span></span></span><span class="z-meta z-string z-python"><span class="z-string z-quoted z-single z-python">Seed for the RNG<span class="z-punctuation z-definition z-string z-end z-python">&#39;</span></span></span><span class="z-punctuation z-section z-arguments z-end z-python">)</span></span>
</span></td></tr><tr><td>13</td><td><span class="z-source z-python"><span class="z-meta z-function-call z-python"><span class="z-meta z-qualified-name z-python"><span class="z-meta z-generic-name z-python">parser</span></span><span class="z-meta z-qualified-name z-python"><span class="z-punctuation z-accessor z-dot z-python">.</span></span><span class="z-meta z-qualified-name z-python"><span class="z-variable z-function z-python"><span class="z-meta z-generic-name z-python">add_argument</span></span></span></span><span class="z-meta z-function-call z-arguments z-python"><span class="z-punctuation z-section z-arguments z-begin z-python">(</span><span class="z-meta z-string z-python"><span class="z-string z-quoted z-single z-python"><span class="z-punctuation z-definition z-string z-begin z-python">&#39;</span></span></span><span class="z-meta z-string z-python"><span class="z-string z-quoted z-single z-python">zero_prob<span class="z-punctuation z-definition z-string z-end z-python">&#39;</span></span></span><span class="z-punctuation z-separator z-arguments z-python">,</span> <span class="z-variable z-parameter z-python">type</span><span class="z-keyword z-operator z-assignment z-python">=</span><span class="z-meta z-qualified-name z-python"><span class="z-support z-type z-python">int</span></span><span class="z-punctuation z-separator z-arguments z-python">,</span> <span class="z-variable z-parameter z-python">choices</span><span class="z-keyword z-operator z-assignment z-python">=</span><span class="z-meta z-function-call z-python"><span class="z-meta z-qualified-name z-python"><span class="z-variable z-function z-python"><span class="z-support z-function z-builtin z-python">range</span></span></span></span><span class="z-meta z-function-call z-arguments z-python"><span class="z-punctuation z-section z-arguments z-begin z-python">(</span><span class="z-constant z-numeric z-integer z-decimal z-python">0</span><span class="z-punctuation z-separator z-arguments z-python">,</span><span class="z-constant z-numeric z-integer z-decimal z-python">101</span><span class="z-punctuation z-section z-arguments z-end z-python">)</span></span><span class="z-punctuation z-separator z-arguments z-python">,</span> <span class="z-variable z-parameter z-python">metavar</span><span class="z-keyword z-operator z-assignment z-python">=</span><span class="z-meta z-string z-python"><span class="z-string z-quoted z-double z-python"><span class="z-punctuation z-definition z-string z-begin z-python">&quot;</span></span></span><span class="z-meta z-string z-python"><span class="z-string z-quoted z-double z-python">[0-100]<span class="z-punctuation z-definition z-string z-end z-python">&quot;</span></span></span><span class="z-punctuation z-separator z-arguments z-python">,</span>
</span></span></td></tr><tr><td>14</td><td><span class="z-source z-python"><span class="z-meta z-function-call z-arguments z-python">                    <span class="z-variable z-parameter z-python">help</span><span class="z-keyword z-operator z-assignment z-python">=</span><span class="z-meta z-string z-python"><span class="z-string z-quoted z-single z-python"><span class="z-punctuation z-definition z-string z-begin z-python">&#39;</span></span></span><span class="z-meta z-string z-python"><span class="z-string z-quoted z-single z-python">Probability of an element being zero<span class="z-punctuation z-definition z-string z-end z-python">&#39;</span></span></span><span class="z-punctuation z-section z-arguments z-end z-python">)</span></span>
</span></td></tr><tr><td>15</td><td><span class="z-source z-python"><span class="z-meta z-function-call z-python"><span class="z-meta z-qualified-name z-python"><span class="z-meta z-generic-name z-python">parser</span></span><span class="z-meta z-qualified-name z-python"><span class="z-punctuation z-accessor z-dot z-python">.</span></span><span class="z-meta z-qualified-name z-python"><span class="z-variable z-function z-python"><span class="z-meta z-generic-name z-python">add_argument</span></span></span></span><span class="z-meta z-function-call z-arguments z-python"><span class="z-punctuation z-section z-arguments z-begin z-python">(</span><span class="z-meta z-string z-python"><span class="z-string z-quoted z-single z-python"><span class="z-punctuation z-definition z-string z-begin z-python">&#39;</span></span></span><span class="z-meta z-string z-python"><span class="z-string z-quoted z-single z-python">--max_val<span class="z-punctuation z-definition z-string z-end z-python">&#39;</span></span></span><span class="z-punctuation z-separator z-arguments z-python">,</span> <span class="z-variable z-parameter z-python">type</span><span class="z-keyword z-operator z-assignment z-python">=</span><span class="z-meta z-qualified-name z-python"><span class="z-support z-type z-python">int</span></span><span class="z-punctuation z-separator z-arguments z-python">,</span>
</span></span></td></tr><tr><td>16</td><td><span class="z-source z-python"><span class="z-meta z-function-call z-arguments z-python">                    <span class="z-variable z-parameter z-python">help</span><span class="z-keyword z-operator z-assignment z-python">=</span><span class="z-meta z-string z-python"><span class="z-string z-quoted z-single z-python"><span class="z-punctuation z-definition z-string z-begin z-python">&#39;</span></span></span><span class="z-meta z-string z-python"><span class="z-string z-quoted z-single z-python">Optional maximum value for each element<span class="z-punctuation z-definition z-string z-end z-python">&#39;</span></span></span><span class="z-punctuation z-section z-arguments z-end z-python">)</span></span>
</span></td></tr><tr><td>17</td><td><span class="z-source z-python">
</span></td></tr><tr><td>18</td><td><span class="z-source z-python"><span class="z-meta z-qualified-name z-python"><span class="z-meta z-generic-name z-python">args</span></span> <span class="z-keyword z-operator z-assignment z-python">=</span> <span class="z-meta z-function-call z-python"><span class="z-meta z-qualified-name z-python"><span class="z-meta z-generic-name z-python">parser</span></span><span class="z-meta z-qualified-name z-python"><span class="z-punctuation z-accessor z-dot z-python">.</span></span><span class="z-meta z-qualified-name z-python"><span class="z-variable z-function z-python"><span class="z-meta z-generic-name z-python">parse_args</span></span></span></span><span class="z-meta z-function-call z-arguments z-python"><span class="z-punctuation z-section z-arguments z-begin z-python">(</span><span class="z-punctuation z-section z-arguments z-end z-python">)</span></span>
</span></td></tr><tr><td>19</td><td><span class="z-source z-python">
</span></td></tr><tr><td>20</td><td><span class="z-source z-python"><span class="z-meta z-function-call z-python"><span class="z-meta z-qualified-name z-python"><span class="z-meta z-generic-name z-python">random</span></span><span class="z-meta z-qualified-name z-python"><span class="z-punctuation z-accessor z-dot z-python">.</span></span><span class="z-meta z-qualified-name z-python"><span class="z-variable z-function z-python"><span class="z-meta z-generic-name z-python">seed</span></span></span></span><span class="z-meta z-function-call z-arguments z-python"><span class="z-punctuation z-section z-arguments z-begin z-python">(</span><span class="z-meta z-qualified-name z-python"><span class="z-meta z-generic-name z-python">args</span><span class="z-punctuation z-accessor z-dot z-python">.</span><span class="z-meta z-generic-name z-python">seed</span></span><span class="z-punctuation z-section z-arguments z-end z-python">)</span></span>
</span></td></tr><tr><td>21</td><td><span class="z-source z-python">
</span></td></tr><tr><td>22</td><td><span class="z-source z-python"><span class="z-meta z-qualified-name z-python"><span class="z-meta z-generic-name z-python">max_val</span></span> <span class="z-keyword z-operator z-assignment z-python">=</span> <span class="z-constant z-numeric z-integer z-decimal z-python">2</span><span class="z-keyword z-operator z-arithmetic z-python">*</span><span class="z-keyword z-operator z-arithmetic z-python">*</span><span class="z-constant z-numeric z-integer z-decimal z-python">64</span> <span class="z-keyword z-operator z-arithmetic z-python">/</span><span class="z-keyword z-operator z-arithmetic z-python">/</span> <span class="z-meta z-group z-python"><span class="z-punctuation z-section z-group z-begin z-python">(</span><span class="z-meta z-qualified-name z-python"><span class="z-meta z-generic-name z-python">args</span><span class="z-punctuation z-accessor z-dot z-python">.</span><span class="z-meta z-generic-name z-python">M</span></span><span class="z-keyword z-operator z-arithmetic z-python">*</span><span class="z-meta z-qualified-name z-python"><span class="z-meta z-generic-name z-python">args</span><span class="z-punctuation z-accessor z-dot z-python">.</span><span class="z-meta z-generic-name z-python">N</span></span><span class="z-punctuation z-section z-group z-end z-python">)</span></span>
</span></td></tr><tr><td>23</td><td><span class="z-source z-python"><span class="z-meta z-statement z-conditional z-if z-python"><span class="z-keyword z-control z-conditional z-if z-python">if</span> <span class="z-meta z-qualified-name z-python"><span class="z-meta z-generic-name z-python">args</span><span class="z-punctuation z-accessor z-dot z-python">.</span><span class="z-meta z-generic-name z-python">max_val</span></span> <span class="z-keyword z-operator z-logical z-python">is</span> <span class="z-keyword z-operator z-logical z-python">not</span> <span class="z-constant z-language z-python">None</span><span class="z-punctuation z-section z-block z-conditional z-if z-python">:</span></span>
</span></td></tr><tr><td>24</td><td><span class="z-source z-python">    <span class="z-meta z-statement z-conditional z-if z-python"><span class="z-keyword z-control z-conditional z-if z-python">if</span> <span class="z-meta z-qualified-name z-python"><span class="z-meta z-generic-name z-python">args</span><span class="z-punctuation z-accessor z-dot z-python">.</span><span class="z-meta z-generic-name z-python">max_val</span></span> <span class="z-keyword z-operator z-comparison z-python">&gt;</span> <span class="z-meta z-qualified-name z-python"><span class="z-meta z-generic-name z-python">max_val</span></span><span class="z-punctuation z-section z-block z-conditional z-if z-python">:</span></span>
</span></td></tr><tr><td>25</td><td><span class="z-source z-python">        <span class="z-meta z-function-call z-python"><span class="z-meta z-qualified-name z-python"><span class="z-variable z-function z-python"><span class="z-support z-function z-builtin z-python">print</span></span></span></span><span class="z-meta z-function-call z-arguments z-python"><span class="z-punctuation z-section z-arguments z-begin z-python">(</span><span class="z-storage z-type z-string z-python">f</span><span class="z-meta z-string z-interpolated z-python"><span class="z-string z-quoted z-double z-python"><span class="z-punctuation z-definition z-string z-begin z-python">&quot;</span></span></span><span class="z-meta z-string z-interpolated z-python"><span class="z-meta z-interpolation z-python"><span class="z-punctuation z-section z-interpolation z-begin z-python">{</span><span class="z-source z-python z-embedded"><span class="z-meta z-qualified-name z-python"><span class="z-meta z-generic-name z-python">args</span><span class="z-punctuation z-accessor z-dot z-python">.</span><span class="z-meta z-generic-name z-python">max_val</span></span></span><span class="z-storage z-modifier z-debug z-python">=</span></span><span class="z-meta z-interpolation z-python"><span class="z-punctuation z-section z-interpolation z-end z-python">}</span></span><span class="z-string z-quoted z-double z-python"> must be no bigger than </span><span class="z-meta z-interpolation z-python"><span class="z-punctuation z-section z-interpolation z-begin z-python">{</span><span class="z-source z-python z-embedded"><span class="z-meta z-qualified-name z-python"><span class="z-meta z-generic-name z-python">max_val</span></span></span></span><span class="z-meta z-interpolation z-python"><span class="z-punctuation z-section z-interpolation z-end z-python">}</span></span><span class="z-string z-quoted z-double z-python">, 2^64//(M*N)<span class="z-punctuation z-definition z-string z-end z-python">&quot;</span></span></span><span class="z-punctuation z-separator z-arguments z-python">,</span>
</span></span></td></tr><tr><td>26</td><td><span class="z-source z-python"><span class="z-meta z-function-call z-arguments z-python">              <span class="z-variable z-parameter z-python">file</span><span class="z-keyword z-operator z-assignment z-python">=</span><span class="z-meta z-qualified-name z-python"><span class="z-meta z-generic-name z-python">sys</span><span class="z-punctuation z-accessor z-dot z-python">.</span><span class="z-meta z-generic-name z-python">stderr</span></span><span class="z-punctuation z-section z-arguments z-end z-python">)</span></span>
</span></td></tr><tr><td>27</td><td><span class="z-source z-python">        <span class="z-meta z-function-call z-python"><span class="z-meta z-qualified-name z-python"><span class="z-meta z-generic-name z-python">sys</span></span><span class="z-meta z-qualified-name z-python"><span class="z-punctuation z-accessor z-dot z-python">.</span></span><span class="z-meta z-qualified-name z-python"><span class="z-variable z-function z-python"><span class="z-meta z-generic-name z-python">exit</span></span></span></span><span class="z-meta z-function-call z-arguments z-python"><span class="z-punctuation z-section z-arguments z-begin z-python">(</span><span class="z-constant z-numeric z-integer z-decimal z-python">1</span><span class="z-punctuation z-section z-arguments z-end z-python">)</span></span>
</span></td></tr><tr><td>28</td><td><span class="z-source z-python">    <span class="z-meta z-statement z-conditional z-else z-python"><span class="z-keyword z-control z-conditional z-else z-python">else</span><span class="z-punctuation z-section z-block z-conditional z-else z-python">:</span></span>
</span></td></tr><tr><td>29</td><td><span class="z-source z-python">        <span class="z-meta z-qualified-name z-python"><span class="z-meta z-generic-name z-python">max_val</span></span> <span class="z-keyword z-operator z-assignment z-python">=</span> <span class="z-meta z-qualified-name z-python"><span class="z-meta z-generic-name z-python">args</span><span class="z-punctuation z-accessor z-dot z-python">.</span><span class="z-meta z-generic-name z-python">max_val</span></span>
</span></td></tr><tr><td>30</td><td><span class="z-source z-python">
</span></td></tr><tr><td>31</td><td><span class="z-source z-python"><span class="z-meta z-function-call z-python"><span class="z-meta z-qualified-name z-python"><span class="z-variable z-function z-python"><span class="z-support z-function z-builtin z-python">print</span></span></span></span><span class="z-meta z-function-call z-arguments z-python"><span class="z-punctuation z-section z-arguments z-begin z-python">(</span><span class="z-storage z-type z-string z-python">f</span><span class="z-meta z-string z-interpolated z-python"><span class="z-string z-quoted z-double z-python"><span class="z-punctuation z-definition z-string z-begin z-python">&quot;</span></span></span><span class="z-meta z-string z-interpolated z-python"><span class="z-meta z-interpolation z-python"><span class="z-punctuation z-section z-interpolation z-begin z-python">{</span><span class="z-source z-python z-embedded"><span class="z-meta z-qualified-name z-python"><span class="z-meta z-generic-name z-python">args</span><span class="z-punctuation z-accessor z-dot z-python">.</span><span class="z-meta z-generic-name z-python">M</span></span></span></span><span class="z-meta z-interpolation z-python"><span class="z-punctuation z-section z-interpolation z-end z-python">}</span></span><span class="z-string z-quoted z-double z-python"> </span><span class="z-meta z-interpolation z-python"><span class="z-punctuation z-section z-interpolation z-begin z-python">{</span><span class="z-source z-python z-embedded"><span class="z-meta z-qualified-name z-python"><span class="z-meta z-generic-name z-python">args</span><span class="z-punctuation z-accessor z-dot z-python">.</span><span class="z-meta z-generic-name z-python">N</span></span></span></span><span class="z-meta z-interpolation z-python"><span class="z-punctuation z-section z-interpolation z-end z-python">}</span></span><span class="z-string z-quoted z-double z-python"><span class="z-punctuation z-definition z-string z-end z-python">&quot;</span></span></span><span class="z-punctuation z-section z-arguments z-end z-python">)</span></span>
</span></td></tr><tr><td>32</td><td><span class="z-source z-python">
</span></td></tr><tr><td>33</td><td><span class="z-source z-python"><span class="z-meta z-qualified-name z-python"><span class="z-meta z-generic-name z-python">printedNonZero</span></span> <span class="z-keyword z-operator z-assignment z-python">=</span> <span class="z-constant z-language z-python">False</span>
</span></td></tr><tr><td>34</td><td><span class="z-source z-python"><span class="z-meta z-statement z-loop z-for z-python"><span class="z-keyword z-control z-loop z-for z-python">for</span> <span class="z-meta z-generic-name z-python">r</span> <span class="z-keyword z-control z-loop z-for z-in z-python">in</span></span><span class="z-meta z-statement z-loop z-for z-python"> <span class="z-meta z-function-call z-python"><span class="z-meta z-qualified-name z-python"><span class="z-variable z-function z-python"><span class="z-support z-function z-builtin z-python">range</span></span></span></span><span class="z-meta z-function-call z-arguments z-python"><span class="z-punctuation z-section z-arguments z-begin z-python">(</span><span class="z-meta z-qualified-name z-python"><span class="z-meta z-generic-name z-python">args</span><span class="z-punctuation z-accessor z-dot z-python">.</span><span class="z-meta z-generic-name z-python">M</span></span><span class="z-punctuation z-section z-arguments z-end z-python">)</span></span></span><span class="z-meta z-statement z-loop z-for z-python"><span class="z-punctuation z-section z-block z-loop z-for z-python">:</span></span>
</span></td></tr><tr><td>35</td><td><span class="z-source z-python">    <span class="z-meta z-statement z-loop z-for z-python"><span class="z-keyword z-control z-loop z-for z-python">for</span> <span class="z-meta z-generic-name z-python">c</span> <span class="z-keyword z-control z-loop z-for z-in z-python">in</span></span><span class="z-meta z-statement z-loop z-for z-python"> <span class="z-meta z-function-call z-python"><span class="z-meta z-qualified-name z-python"><span class="z-variable z-function z-python"><span class="z-support z-function z-builtin z-python">range</span></span></span></span><span class="z-meta z-function-call z-arguments z-python"><span class="z-punctuation z-section z-arguments z-begin z-python">(</span><span class="z-meta z-qualified-name z-python"><span class="z-meta z-generic-name z-python">args</span><span class="z-punctuation z-accessor z-dot z-python">.</span><span class="z-meta z-generic-name z-python">N</span></span><span class="z-punctuation z-section z-arguments z-end z-python">)</span></span></span><span class="z-meta z-statement z-loop z-for z-python"><span class="z-punctuation z-section z-block z-loop z-for z-python">:</span></span>
</span></td></tr><tr><td>36</td><td><span class="z-source z-python">        <span class="z-comment z-line z-number-sign z-python"><span class="z-punctuation z-definition z-comment z-python">#</span> XXX: this method of setting the probability of zeroes is probably not sound
</span></span></td></tr><tr><td>37</td><td><span class="z-source z-python">        <span class="z-meta z-statement z-conditional z-if z-python"><span class="z-keyword z-control z-conditional z-if z-python">if</span> <span class="z-meta z-function-call z-python"><span class="z-meta z-qualified-name z-python"><span class="z-meta z-generic-name z-python">random</span></span><span class="z-meta z-qualified-name z-python"><span class="z-punctuation z-accessor z-dot z-python">.</span></span><span class="z-meta z-qualified-name z-python"><span class="z-variable z-function z-python"><span class="z-meta z-generic-name z-python">random</span></span></span></span><span class="z-meta z-function-call z-arguments z-python"><span class="z-punctuation z-section z-arguments z-begin z-python">(</span><span class="z-punctuation z-section z-arguments z-end z-python">)</span></span> <span class="z-keyword z-operator z-comparison z-python">&lt;</span> <span class="z-meta z-qualified-name z-python"><span class="z-meta z-generic-name z-python">args</span><span class="z-punctuation z-accessor z-dot z-python">.</span><span class="z-meta z-generic-name z-python">zero_prob</span></span><span class="z-keyword z-operator z-arithmetic z-python">/</span><span class="z-constant z-numeric z-integer z-decimal z-python">100</span> <span class="z-keyword z-operator z-logical z-python">and</span> <span class="z-meta z-qualified-name z-python"><span class="z-meta z-generic-name z-python">printedNonZero</span></span><span class="z-punctuation z-section z-block z-conditional z-if z-python">:</span></span>
</span></td></tr><tr><td>38</td><td><span class="z-source z-python">            <span class="z-meta z-function-call z-python"><span class="z-meta z-qualified-name z-python"><span class="z-variable z-function z-python"><span class="z-support z-function z-builtin z-python">print</span></span></span></span><span class="z-meta z-function-call z-arguments z-python"><span class="z-punctuation z-section z-arguments z-begin z-python">(</span><span class="z-meta z-string z-python"><span class="z-string z-quoted z-single z-python"><span class="z-punctuation z-definition z-string z-begin z-python">&#39;</span></span></span><span class="z-meta z-string z-python"><span class="z-string z-quoted z-single z-python">0 <span class="z-punctuation z-definition z-string z-end z-python">&#39;</span></span></span><span class="z-punctuation z-separator z-arguments z-python">,</span> <span class="z-variable z-parameter z-python">end</span><span class="z-keyword z-operator z-assignment z-python">=</span><span class="z-meta z-string z-python"><span class="z-string z-quoted z-single z-python"><span class="z-punctuation z-definition z-string z-begin z-python">&#39;</span></span></span><span class="z-meta z-string z-python"><span class="z-string z-quoted z-single z-python"><span class="z-punctuation z-definition z-string z-end z-python">&#39;</span></span></span><span class="z-punctuation z-section z-arguments z-end z-python">)</span></span>
</span></td></tr><tr><td>39</td><td><span class="z-source z-python">        <span class="z-meta z-statement z-conditional z-else z-python"><span class="z-keyword z-control z-conditional z-else z-python">else</span><span class="z-punctuation z-section z-block z-conditional z-else z-python">:</span></span>
</span></td></tr><tr><td>40</td><td><span class="z-source z-python">            <span class="z-meta z-function-call z-python"><span class="z-meta z-qualified-name z-python"><span class="z-variable z-function z-python"><span class="z-support z-function z-builtin z-python">print</span></span></span></span><span class="z-meta z-function-call z-arguments z-python"><span class="z-punctuation z-section z-arguments z-begin z-python">(</span><span class="z-storage z-type z-string z-python">f</span><span class="z-meta z-string z-interpolated z-python"><span class="z-string z-quoted z-double z-python"><span class="z-punctuation z-definition z-string z-begin z-python">&quot;</span></span></span><span class="z-meta z-string z-interpolated z-python"><span class="z-meta z-interpolation z-python"><span class="z-punctuation z-section z-interpolation z-begin z-python">{</span><span class="z-source z-python z-embedded"><span class="z-meta z-function-call z-python"><span class="z-meta z-qualified-name z-python"><span class="z-meta z-generic-name z-python">random</span></span><span class="z-meta z-qualified-name z-python"><span class="z-punctuation z-accessor z-dot z-python">.</span></span><span class="z-meta z-qualified-name z-python"><span class="z-variable z-function z-python"><span class="z-meta z-generic-name z-python">randint</span></span></span></span><span class="z-meta z-function-call z-arguments z-python"><span class="z-punctuation z-section z-arguments z-begin z-python">(</span><span class="z-constant z-numeric z-integer z-decimal z-python">1</span><span class="z-punctuation z-separator z-arguments z-python">,</span> <span class="z-meta z-qualified-name z-python"><span class="z-meta z-generic-name z-python">max_val</span></span><span class="z-punctuation z-section z-arguments z-end z-python">)</span></span></span></span><span class="z-meta z-interpolation z-python"><span class="z-punctuation z-section z-interpolation z-end z-python">}</span></span><span class="z-string z-quoted z-double z-python"> <span class="z-punctuation z-definition z-string z-end z-python">&quot;</span></span></span><span class="z-punctuation z-separator z-arguments z-python">,</span> <span class="z-variable z-parameter z-python">end</span><span class="z-keyword z-operator z-assignment z-python">=</span><span class="z-meta z-string z-python"><span class="z-string z-quoted z-single z-python"><span class="z-punctuation z-definition z-string z-begin z-python">&#39;</span></span></span><span class="z-meta z-string z-python"><span class="z-string z-quoted z-single z-python"><span class="z-punctuation z-definition z-string z-end z-python">&#39;</span></span></span><span class="z-punctuation z-section z-arguments z-end z-python">)</span></span>
</span></td></tr><tr><td>41</td><td><span class="z-source z-python">            <span class="z-meta z-qualified-name z-python"><span class="z-meta z-generic-name z-python">printedNonZero</span></span> <span class="z-keyword z-operator z-assignment z-python">=</span> <span class="z-constant z-language z-python">True</span>
</span></td></tr><tr><td>42</td><td><span class="z-source z-python">    <span class="z-meta z-function-call z-python"><span class="z-meta z-qualified-name z-python"><span class="z-variable z-function z-python"><span class="z-support z-function z-builtin z-python">print</span></span></span></span><span class="z-meta z-function-call z-arguments z-python"><span class="z-punctuation z-section z-arguments z-begin z-python">(</span><span class="z-punctuation z-section z-arguments z-end z-python">)</span></span>
</span></td></tr></tbody></table></code></pre>
<ol start="2">
<li>We can test the correctness of the result for small inputs using a brute-force solution, for example <a href="https://orthogonalscribe.github.io/max-submatrix/maxSubmatrixBF.sc"><code>maxSubmatrixBF.sc</code></a>, an Ammonite (Scala 3) script:</li>
</ol>
<pre data-linenos data-lang="sc" class="language-sc z-code"><code class="language-sc" data-lang="sc"><table><tbody><tr><td>1</td><td><span class="z-source z-scala">#!/usr/bin/env amm3
</span></td></tr><tr><td>2</td><td><span class="z-source z-scala">
</span></td></tr><tr><td>3</td><td><span class="z-source z-scala"><span class="z-storage z-type z-stable z-scala">val</span> <span class="z-variable z-other z-constant z-scala">A</span> <span class="z-keyword z-operator z-assignment z-scala">=</span> scala<span class="z-punctuation z-accessor z-scala">.</span>io<span class="z-punctuation z-accessor z-scala">.</span><span class="z-support z-constant z-scala">Source</span><span class="z-punctuation z-accessor z-scala">.</span>stdin<span class="z-punctuation z-accessor z-scala">.</span>getLines<span class="z-punctuation z-accessor z-scala">.</span>toArray<span class="z-punctuation z-accessor z-scala">.</span>tail map
</span></td></tr><tr><td>4</td><td><span class="z-source z-scala">  <span class="z-meta z-block z-scala"><span class="z-punctuation z-section z-block z-begin z-scala">{</span><span class="z-variable z-language z-underscore z-scala">_</span> split <span class="z-string z-quoted z-double z-scala"><span class="z-punctuation z-definition z-string z-begin z-scala">&quot;</span> <span class="z-punctuation z-definition z-string z-end z-scala">&quot;</span></span> filter <span class="z-meta z-block z-scala"><span class="z-punctuation z-section z-block z-begin z-scala">{</span><span class="z-variable z-language z-underscore z-scala">_</span><span class="z-punctuation z-accessor z-scala">.</span>nonEmpty<span class="z-punctuation z-section z-block z-end z-scala">}</span></span> map <span class="z-support z-constant z-scala">BigInt</span><span class="z-punctuation z-accessor z-scala">.</span>apply<span class="z-punctuation z-section z-block z-end z-scala">}</span></span>
</span></td></tr><tr><td>5</td><td><span class="z-source z-scala">
</span></td></tr><tr><td>6</td><td><span class="z-source z-scala"><span class="z-meta z-class z-identifier z-scala"><span class="z-storage z-type z-class z-scala">case </span><span class="z-storage z-type z-class z-scala">class</span><span class="z-entity z-name z-class z-scala"> Max</span></span><span class="z-punctuation z-section z-group z-begin z-scala">(</span><span class="z-variable z-parameter z-scala">sum</span><span class="z-punctuation z-ascription z-scala">:</span> <span class="z-support z-class z-scala">BigInt</span><span class="z-punctuation z-separator z-scala">,</span> <span class="z-variable z-parameter z-scala">uli</span><span class="z-punctuation z-ascription z-scala">:</span> <span class="z-storage z-type z-primitive z-scala">Int</span><span class="z-punctuation z-separator z-scala">,</span> <span class="z-variable z-parameter z-scala">ulj</span><span class="z-punctuation z-ascription z-scala">:</span> <span class="z-storage z-type z-primitive z-scala">Int</span><span class="z-punctuation z-separator z-scala">,</span> <span class="z-variable z-parameter z-scala">width</span><span class="z-punctuation z-ascription z-scala">:</span> <span class="z-storage z-type z-primitive z-scala">Int</span><span class="z-punctuation z-section z-group z-end z-scala">)</span>
</span></td></tr><tr><td>7</td><td><span class="z-source z-scala">
</span></td></tr><tr><td>8</td><td><span class="z-source z-scala"><span class="z-storage z-type z-volatile z-scala">var</span> <span class="z-variable z-other z-readwrite z-scala">m</span> <span class="z-keyword z-operator z-assignment z-scala">=</span> <span class="z-support z-constant z-scala">Max</span><span class="z-punctuation z-section z-group z-begin z-scala">(</span>-<span class="z-constant z-numeric z-integer z-decimal z-scala">1</span><span class="z-punctuation z-separator z-scala">,</span>-<span class="z-constant z-numeric z-integer z-decimal z-scala">1</span><span class="z-punctuation z-separator z-scala">,</span>-<span class="z-constant z-numeric z-integer z-decimal z-scala">1</span><span class="z-punctuation z-separator z-scala">,</span>-<span class="z-constant z-numeric z-integer z-decimal z-scala">1</span><span class="z-punctuation z-section z-group z-end z-scala">)</span>
</span></td></tr><tr><td>9</td><td><span class="z-source z-scala">
</span></td></tr><tr><td>10</td><td><span class="z-source z-scala"><span class="z-keyword z-control z-flow z-scala">for</span>
</span></td></tr><tr><td>11</td><td><span class="z-source z-scala">  i &lt;- <span class="z-support z-constant z-scala">A</span>   <span class="z-punctuation z-accessor z-scala">.</span>indices
</span></td></tr><tr><td>12</td><td><span class="z-source z-scala">  j &lt;- <span class="z-support z-constant z-scala">A</span><span class="z-punctuation z-section z-group z-begin z-scala">(</span>i<span class="z-punctuation z-section z-group z-end z-scala">)</span><span class="z-punctuation z-accessor z-scala">.</span>indices
</span></td></tr><tr><td>13</td><td><span class="z-source z-scala">  width &lt;- <span class="z-constant z-numeric z-integer z-decimal z-scala">1</span> to <span class="z-meta z-group z-scala"><span class="z-punctuation z-section z-group z-begin z-scala">(</span><span class="z-meta z-group z-scala"><span class="z-punctuation z-section z-group z-begin z-scala">(</span>i min j<span class="z-punctuation z-section z-group z-end z-scala">)</span></span> + <span class="z-constant z-numeric z-integer z-decimal z-scala">1</span><span class="z-punctuation z-section z-group z-end z-scala">)</span></span>
</span></td></tr><tr><td>14</td><td><span class="z-source z-scala">
</span></td></tr><tr><td>15</td><td><span class="z-source z-scala">  uli <span class="z-keyword z-operator z-assignment z-scala">=</span> i - width + <span class="z-constant z-numeric z-integer z-decimal z-scala">1</span>
</span></td></tr><tr><td>16</td><td><span class="z-source z-scala">  ulj <span class="z-keyword z-operator z-assignment z-scala">=</span> j - width + <span class="z-constant z-numeric z-integer z-decimal z-scala">1</span>
</span></td></tr><tr><td>17</td><td><span class="z-source z-scala">  region <span class="z-keyword z-operator z-assignment z-scala">=</span> <span class="z-meta z-group z-scala"><span class="z-punctuation z-section z-group z-begin z-scala">(</span>uli to i map <span class="z-support z-constant z-scala">A</span><span class="z-punctuation z-section z-group z-end z-scala">)</span></span> map <span class="z-meta z-block z-scala"><span class="z-punctuation z-section z-block z-begin z-scala">{</span>ulj to j map <span class="z-variable z-language z-underscore z-scala">_</span><span class="z-punctuation z-section z-block z-end z-scala">}</span></span>
</span></td></tr><tr><td>18</td><td><span class="z-source z-scala">
</span></td></tr><tr><td>19</td><td><span class="z-source z-scala">  <span class="z-keyword z-control z-flow z-scala">if</span> region forall <span class="z-meta z-block z-scala"><span class="z-punctuation z-section z-block z-begin z-scala">{</span><span class="z-variable z-language z-underscore z-scala">_</span> forall <span class="z-constant z-numeric z-integer z-decimal z-scala">0</span><span class="z-punctuation z-accessor z-scala">.</span><span class="z-keyword z-operator z-comparison z-scala">!=</span><span class="z-punctuation z-section z-block z-end z-scala">}</span></span>
</span></td></tr><tr><td>20</td><td><span class="z-source z-scala">  sum <span class="z-keyword z-operator z-assignment z-scala">=</span> region<span class="z-punctuation z-accessor z-scala">.</span>map<span class="z-meta z-block z-scala"><span class="z-punctuation z-section z-block z-begin z-scala">{</span><span class="z-variable z-language z-underscore z-scala">_</span><span class="z-punctuation z-accessor z-scala">.</span>sum<span class="z-punctuation z-section z-block z-end z-scala">}</span></span><span class="z-punctuation z-accessor z-scala">.</span>sum
</span></td></tr><tr><td>21</td><td><span class="z-source z-scala">  <span class="z-keyword z-control z-flow z-scala">if</span> sum &gt; m<span class="z-punctuation z-accessor z-scala">.</span>sum
</span></td></tr><tr><td>22</td><td><span class="z-source z-scala"><span class="z-keyword z-control z-flow z-scala">do</span>
</span></td></tr><tr><td>23</td><td><span class="z-source z-scala">  m <span class="z-keyword z-operator z-assignment z-scala">=</span> <span class="z-support z-constant z-scala">Max</span><span class="z-punctuation z-section z-group z-begin z-scala">(</span>sum<span class="z-punctuation z-separator z-scala">,</span> uli<span class="z-punctuation z-separator z-scala">,</span> ulj<span class="z-punctuation z-separator z-scala">,</span> width<span class="z-punctuation z-section z-group z-end z-scala">)</span>
</span></td></tr><tr><td>24</td><td><span class="z-source z-scala">
</span></td></tr><tr><td>25</td><td><span class="z-source z-scala">println<span class="z-punctuation z-section z-group z-begin z-scala">(</span><span class="z-string z-quoted z-interpolated z-scala"><span class="z-support z-function z-scala">s</span><span class="z-punctuation z-definition z-string z-begin z-scala">&quot;</span>Sum=<span class="z-punctuation z-definition z-expression z-scala">${</span></span><span class="z-source z-scala z-embedded">m<span class="z-punctuation z-accessor z-scala">.</span>sum</span><span class="z-string z-quoted z-interpolated z-scala"><span class="z-punctuation z-definition z-expression z-scala">}</span> in <span class="z-punctuation z-definition z-expression z-scala">${</span></span><span class="z-source z-scala z-embedded">m<span class="z-punctuation z-accessor z-scala">.</span>width</span><span class="z-string z-quoted z-interpolated z-scala"><span class="z-punctuation z-definition z-expression z-scala">}</span>-wide square starting at (<span class="z-punctuation z-definition z-expression z-scala">${</span></span><span class="z-source z-scala z-embedded">m<span class="z-punctuation z-accessor z-scala">.</span>uli</span><span class="z-string z-quoted z-interpolated z-scala"><span class="z-punctuation z-definition z-expression z-scala">}</span>,<span class="z-punctuation z-definition z-expression z-scala">${</span></span><span class="z-source z-scala z-embedded">m<span class="z-punctuation z-accessor z-scala">.</span>ulj</span><span class="z-string z-quoted z-interpolated z-scala"><span class="z-punctuation z-definition z-expression z-scala">}</span>)<span class="z-punctuation z-definition z-string z-end z-scala">&quot;</span></span><span class="z-punctuation z-section z-group z-end z-scala">)</span>
</span></td></tr></tbody></table></code></pre>
<p>Using our input generator and a simple loop, we can decide what input sizes should be used to quickly test via a given brute-force solution:</p>
<pre data-lang="sh" class="language-sh z-code"><code class="language-sh" data-lang="sh"><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">$</span></span><span class="z-meta z-function-call z-arguments z-shell"> for dim in 1 50 100 120 125</span><span class="z-keyword z-operator z-logical z-continue z-shell">;</span> <span class="z-punctuation z-separator z-continuation z-line z-shell">\
</span></span><span class="z-source z-shell z-bash"><span class="z-keyword z-control z-loop z-do z-shell">do</span>
</span><span class="z-source z-shell z-bash">    <span class="z-meta z-function-call z-shell"><span class="z-support z-function z-echo z-shell">echo</span></span><span class="z-meta z-function-call z-arguments z-shell"> - N=<span class="z-meta z-group z-expansion z-parameter z-shell"><span class="z-punctuation z-definition z-variable z-shell">$</span><span class="z-variable z-other z-readwrite z-shell">dim</span></span></span><span class="z-keyword z-operator z-logical z-continue z-shell">;</span> <span class="z-punctuation z-separator z-continuation z-line z-shell">\
</span></span><span class="z-source z-shell z-bash">    <span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">./gen_input.py</span></span><span class="z-meta z-function-call z-arguments z-shell"> <span class="z-meta z-group z-expansion z-parameter z-shell"><span class="z-punctuation z-definition z-variable z-shell">$</span><span class="z-variable z-other z-readwrite z-shell">dim</span></span> <span class="z-meta z-group z-expansion z-parameter z-shell"><span class="z-punctuation z-definition z-variable z-shell">$</span><span class="z-variable z-other z-readwrite z-shell">dim</span></span> 2038 6 <span class="z-punctuation z-separator z-continuation z-line z-shell">\
</span></span></span><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-arguments z-shell"></span>        <span class="z-keyword z-operator z-logical z-pipe z-shell">|</span> <span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">tee</span></span><span class="z-meta z-function-call z-arguments z-shell"> <span class="z-keyword z-operator z-assignment z-redirection z-process z-shell">&gt;</span><span class="z-punctuation z-section z-parens z-begin z-shell">(</span><span class="z-meta z-function-call z-shell"></span><span class="z-meta z-function-call z-arguments z-shell"><span class="z-meta z-group z-expansion z-command z-backticks z-shell"><span class="z-punctuation z-section z-group z-begin z-shell">`</span><span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">which</span></span><span class="z-meta z-function-call z-arguments z-shell"> time</span><span class="z-punctuation z-section z-group z-end z-shell">`</span></span><span class="z-variable z-parameter z-option z-shell"><span class="z-punctuation z-definition z-parameter z-shell"> -</span>f</span> <span class="z-string z-quoted z-single z-shell"><span class="z-punctuation z-definition z-string z-begin z-shell">&#39;</span>%E real<span class="z-punctuation z-definition z-string z-end z-shell">&#39;</span></span> ./a.out <span class="z-keyword z-operator z-assignment z-redirection z-shell">&gt;&amp;</span><span class="z-constant z-numeric z-integer z-decimal z-file-descriptor z-shell">2</span></span><span class="z-punctuation z-section z-parens z-end z-shell">)</span> <span class="z-punctuation z-separator z-continuation z-line z-shell">\
</span></span></span><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-arguments z-shell"></span>        <span class="z-keyword z-operator z-logical z-pipe z-shell">|</span> <span class="z-meta z-function-call z-shell"></span><span class="z-meta z-function-call z-arguments z-shell"><span class="z-meta z-group z-expansion z-command z-backticks z-shell"><span class="z-punctuation z-section z-group z-begin z-shell">`</span><span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">which</span></span><span class="z-meta z-function-call z-arguments z-shell"> time</span><span class="z-punctuation z-section z-group z-end z-shell">`</span></span><span class="z-variable z-parameter z-option z-shell"><span class="z-punctuation z-definition z-parameter z-shell"> -</span>f</span> <span class="z-string z-quoted z-single z-shell"><span class="z-punctuation z-definition z-string z-begin z-shell">&#39;</span>%E real<span class="z-punctuation z-definition z-string z-end z-shell">&#39;</span></span> ./maxSubmatrixBF.sc</span><span class="z-keyword z-operator z-logical z-continue z-shell">;</span>
</span><span class="z-source z-shell z-bash"><span class="z-keyword z-control z-loop z-end z-shell">done</span>
</span><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">-</span></span><span class="z-meta z-function-call z-arguments z-shell"> N=1</span>
</span><span class="z-source z-shell z-bash"><span class="z-variable z-other z-readwrite z-assignment z-shell">Sum</span><span class="z-keyword z-operator z-assignment z-shell">=</span><span class="z-string z-unquoted z-shell">1326596463542876959</span> <span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">in</span></span><span class="z-meta z-function-call z-arguments z-shell"> 1-wide square starting at (0,0</span><span class="z-meta z-function-call z-shell"></span>)
</span><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">0:00.02</span></span><span class="z-meta z-function-call z-arguments z-shell"> real</span>
</span><span class="z-source z-shell z-bash"><span class="z-variable z-other z-readwrite z-assignment z-shell">Sum</span><span class="z-keyword z-operator z-assignment z-shell">=</span><span class="z-string z-unquoted z-shell">1326596463542876959</span> <span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">in</span></span><span class="z-meta z-function-call z-arguments z-shell"> 1-wide square starting at (0,0</span><span class="z-meta z-function-call z-shell"></span>)
</span><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">0:00.63</span></span><span class="z-meta z-function-call z-arguments z-shell"> real</span>
</span><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">-</span></span><span class="z-meta z-function-call z-arguments z-shell"> N=50</span>
</span><span class="z-source z-shell z-bash"><span class="z-variable z-other z-readwrite z-assignment z-shell">Sum</span><span class="z-keyword z-operator z-assignment z-shell">=</span><span class="z-string z-unquoted z-shell">289596670689973733</span> <span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">in</span></span><span class="z-meta z-function-call z-arguments z-shell"> 9-wide square starting at (13,12</span><span class="z-meta z-function-call z-shell"></span>)
</span><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">0:00.03</span></span><span class="z-meta z-function-call z-arguments z-shell"> real</span>
</span><span class="z-source z-shell z-bash"><span class="z-variable z-other z-readwrite z-assignment z-shell">Sum</span><span class="z-keyword z-operator z-assignment z-shell">=</span><span class="z-string z-unquoted z-shell">289596670689973733</span> <span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">in</span></span><span class="z-meta z-function-call z-arguments z-shell"> 9-wide square starting at (13,12</span><span class="z-meta z-function-call z-shell"></span>)
</span><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">0:00.84</span></span><span class="z-meta z-function-call z-arguments z-shell"> real</span>
</span><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">-</span></span><span class="z-meta z-function-call z-arguments z-shell"> N=100</span>
</span><span class="z-source z-shell z-bash"><span class="z-variable z-other z-readwrite z-assignment z-shell">Sum</span><span class="z-keyword z-operator z-assignment z-shell">=</span><span class="z-string z-unquoted z-shell">115092997091208499</span> <span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">in</span></span><span class="z-meta z-function-call z-arguments z-shell"> 11-wide square starting at (0,64</span><span class="z-meta z-function-call z-shell"></span>)
</span><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">0:00.58</span></span><span class="z-meta z-function-call z-arguments z-shell"> real</span>
</span><span class="z-source z-shell z-bash"><span class="z-variable z-other z-readwrite z-assignment z-shell">Sum</span><span class="z-keyword z-operator z-assignment z-shell">=</span><span class="z-string z-unquoted z-shell">115092997091208499</span> <span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">in</span></span><span class="z-meta z-function-call z-arguments z-shell"> 11-wide square starting at (0,64</span><span class="z-meta z-function-call z-shell"></span>)
</span><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">0:03.11</span></span><span class="z-meta z-function-call z-arguments z-shell"> real</span>
</span><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">-</span></span><span class="z-meta z-function-call z-arguments z-shell"> N=120</span>
</span><span class="z-source z-shell z-bash"><span class="z-variable z-other z-readwrite z-assignment z-shell">Sum</span><span class="z-keyword z-operator z-assignment z-shell">=</span><span class="z-string z-unquoted z-shell">66272117197447889</span> <span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">in</span></span><span class="z-meta z-function-call z-arguments z-shell"> 11-wide square starting at (54,87</span><span class="z-meta z-function-call z-shell"></span>)
</span><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">0:00.58</span></span><span class="z-meta z-function-call z-arguments z-shell"> real</span>
</span><span class="z-source z-shell z-bash"><span class="z-variable z-other z-readwrite z-assignment z-shell">Sum</span><span class="z-keyword z-operator z-assignment z-shell">=</span><span class="z-string z-unquoted z-shell">66272117197447889</span> <span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">in</span></span><span class="z-meta z-function-call z-arguments z-shell"> 11-wide square starting at (54,87</span><span class="z-meta z-function-call z-shell"></span>)
</span><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">0:06.33</span></span><span class="z-meta z-function-call z-arguments z-shell"> real</span>
</span><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">-</span></span><span class="z-meta z-function-call z-arguments z-shell"> N=125</span>
</span><span class="z-source z-shell z-bash"><span class="z-variable z-other z-readwrite z-assignment z-shell">Sum</span><span class="z-keyword z-operator z-assignment z-shell">=</span><span class="z-string z-unquoted z-shell">78999073335313433</span> <span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">in</span></span><span class="z-meta z-function-call z-arguments z-shell"> 12-wide square starting at (99,100</span><span class="z-meta z-function-call z-shell"></span>)
</span><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">0:00.60</span></span><span class="z-meta z-function-call z-arguments z-shell"> real</span>
</span><span class="z-source z-shell z-bash"><span class="z-variable z-other z-readwrite z-assignment z-shell">Sum</span><span class="z-keyword z-operator z-assignment z-shell">=</span><span class="z-string z-unquoted z-shell">78999073335313433</span> <span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">in</span></span><span class="z-meta z-function-call z-arguments z-shell"> 12-wide square starting at (99,100</span><span class="z-meta z-function-call z-shell"></span>)
</span><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">0:07.57</span></span><span class="z-meta z-function-call z-arguments z-shell"> real</span>
</span></code></pre>
<ol start="3">
<li>While debugging, we use <a href="https://orthogonalscribe.github.io/max-submatrix/cutRegion.sc"><code>cutRegion.sc</code></a> to narrow down the input that triggers a given issue:</li>
</ol>
<pre data-linenos data-lang="sc" class="language-sc z-code"><code class="language-sc" data-lang="sc"><table><tbody><tr><td>1</td><td><span class="z-source z-scala">#!/usr/bin/env amm3
</span></td></tr><tr><td>2</td><td><span class="z-source z-scala">
</span></td></tr><tr><td>3</td><td><span class="z-source z-scala"><span class="z-meta z-annotation z-scala"><span class="z-punctuation z-definition z-annotation z-scala">@</span></span><span class="z-meta z-annotation z-identifier z-scala"><span class="z-variable z-annotation z-scala">main</span></span>
</span></td></tr><tr><td>4</td><td><span class="z-source z-scala"><span class="z-storage z-type z-function z-scala">def</span> <span class="z-entity z-name z-function z-scala">main</span><span class="z-punctuation z-section z-group z-begin z-scala">(</span><span class="z-variable z-parameter z-scala">r0</span><span class="z-punctuation z-ascription z-scala">:</span> <span class="z-storage z-type z-primitive z-scala">Int</span><span class="z-punctuation z-separator z-scala">,</span> <span class="z-variable z-parameter z-scala">c0</span><span class="z-punctuation z-ascription z-scala">:</span> <span class="z-storage z-type z-primitive z-scala">Int</span><span class="z-punctuation z-separator z-scala">,</span> <span class="z-variable z-parameter z-scala">r1</span><span class="z-punctuation z-ascription z-scala">:</span> <span class="z-storage z-type z-primitive z-scala">Int</span><span class="z-punctuation z-separator z-scala">,</span> <span class="z-variable z-parameter z-scala">c1</span><span class="z-punctuation z-ascription z-scala">:</span> <span class="z-storage z-type z-primitive z-scala">Int</span><span class="z-punctuation z-section z-group z-end z-scala">)</span> <span class="z-keyword z-operator z-assignment z-scala">=</span>
</span></td></tr><tr><td>5</td><td><span class="z-source z-scala">  <span class="z-storage z-type z-stable z-scala">val</span> <span class="z-variable z-other z-constant z-scala">A</span> <span class="z-keyword z-operator z-assignment z-scala">=</span> scala<span class="z-punctuation z-accessor z-scala">.</span>io<span class="z-punctuation z-accessor z-scala">.</span><span class="z-support z-constant z-scala">Source</span><span class="z-punctuation z-accessor z-scala">.</span>stdin<span class="z-punctuation z-accessor z-scala">.</span>getLines<span class="z-punctuation z-accessor z-scala">.</span>toArray<span class="z-punctuation z-accessor z-scala">.</span>tail map
</span></td></tr><tr><td>6</td><td><span class="z-source z-scala">    <span class="z-meta z-block z-scala"><span class="z-punctuation z-section z-block z-begin z-scala">{</span><span class="z-variable z-language z-underscore z-scala">_</span> split <span class="z-string z-quoted z-double z-scala"><span class="z-punctuation z-definition z-string z-begin z-scala">&quot;</span> <span class="z-punctuation z-definition z-string z-end z-scala">&quot;</span></span> filter <span class="z-meta z-block z-scala"><span class="z-punctuation z-section z-block z-begin z-scala">{</span><span class="z-variable z-language z-underscore z-scala">_</span><span class="z-punctuation z-accessor z-scala">.</span>nonEmpty<span class="z-punctuation z-section z-block z-end z-scala">}</span></span> map <span class="z-support z-constant z-scala">BigInt</span><span class="z-punctuation z-accessor z-scala">.</span>apply <span class="z-punctuation z-section z-block z-end z-scala">}</span></span>
</span></td></tr><tr><td>7</td><td><span class="z-source z-scala">
</span></td></tr><tr><td>8</td><td><span class="z-source z-scala">  <span class="z-storage z-type z-volatile z-scala">var</span> <span class="z-variable z-other z-readwrite z-scala">region</span> <span class="z-keyword z-operator z-assignment z-scala">=</span> <span class="z-meta z-group z-scala"><span class="z-punctuation z-section z-group z-begin z-scala">(</span>r0 to r1 map <span class="z-support z-constant z-scala">A</span><span class="z-punctuation z-section z-group z-end z-scala">)</span></span> map <span class="z-meta z-block z-scala"><span class="z-punctuation z-section z-block z-begin z-scala">{</span>c0 to c1 map <span class="z-variable z-language z-underscore z-scala">_</span><span class="z-punctuation z-section z-block z-end z-scala">}</span></span>
</span></td></tr><tr><td>9</td><td><span class="z-source z-scala">
</span></td></tr><tr><td>10</td><td><span class="z-source z-scala">  println<span class="z-punctuation z-section z-group z-begin z-scala">(</span><span class="z-string z-quoted z-interpolated z-scala"><span class="z-support z-function z-scala">s</span><span class="z-punctuation z-definition z-string z-begin z-scala">&quot;</span><span class="z-punctuation z-definition z-expression z-scala">${</span></span><span class="z-source z-scala z-embedded">region<span class="z-punctuation z-accessor z-scala">.</span>size</span><span class="z-string z-quoted z-interpolated z-scala"><span class="z-punctuation z-definition z-expression z-scala">}</span> <span class="z-punctuation z-definition z-expression z-scala">${</span></span><span class="z-source z-scala z-embedded">region<span class="z-punctuation z-accessor z-scala">.</span>head<span class="z-punctuation z-accessor z-scala">.</span>size</span><span class="z-string z-quoted z-interpolated z-scala"><span class="z-punctuation z-definition z-expression z-scala">}</span><span class="z-punctuation z-definition z-string z-end z-scala">&quot;</span></span><span class="z-punctuation z-section z-group z-end z-scala">)</span>
</span></td></tr><tr><td>11</td><td><span class="z-source z-scala">
</span></td></tr><tr><td>12</td><td><span class="z-source z-scala">  region map <span class="z-meta z-block z-scala"><span class="z-punctuation z-section z-block z-begin z-scala">{</span><span class="z-variable z-language z-underscore z-scala">_</span> mkString <span class="z-string z-quoted z-double z-scala"><span class="z-punctuation z-definition z-string z-begin z-scala">&quot;</span> <span class="z-punctuation z-definition z-string z-end z-scala">&quot;</span></span><span class="z-punctuation z-section z-block z-end z-scala">}</span></span> foreach println
</span></td></tr></tbody></table></code></pre>

      <nav>
        <div>
          <a href="https://orthogonalscribe.github.io/lc-332-reconstructing-itinerary/">&#8249; LeetCode 332: Reconstructing Itinerary</a>
        </div>
        <div>
        </div>
      </nav>
    </article>

    <div class="sblock">
      <div class="blockdiv">
        <a class="b s150" href="https://orthogonalscribe.github.io/tags/algorithms/">Series</a>
        <ol>
            
      <li><a class="scur" href="https://orthogonalscribe.github.io/max-submatrix/">Maximum nonzero contiguous square submatrix</a></li>
    
            
      <li><a href="https://orthogonalscribe.github.io/lc-332-reconstructing-itinerary/">LeetCode 332: Reconstructing Itinerary</a></li>
        </ol>
      </div>

      <div class="blockdiv sticky">
        <a class="b s150" href="#">Index</a>
        <div>
          <a href="#problem-statement">Problem statement</a>
        </div>
        <div>
          <a href="#example">Example</a>
        </div>
        <div>
          <a href="#solution">Solution</a>
        </div>
        <div class="hpad">
          <a href="#summed-area-table"><small>- Summed-area table</small></a>
        </div>
        <div class="hpad">
          <a href="#widest-nzcss"><small>- Widest NzCSS</small></a>
        </div>
        <div class="hpad">
          <a href="#finding-the-result"><small>- Finding the result</small></a>
        </div>
        <div class="hpad">
          <a href="#putting-it-all-together"><small>- Putting it all together</small></a>
        </div>
        <div>
          <a href="#helper-scripts">Helper scripts</a>
        </div>
      </div>
    </div>
  </main>
  <footer>
    <hr />
    <div class="c">
      <nav><div><a type="application/atom+xml" href="https://orthogonalscribe.github.io/atom.xml" target="_blank" title="OrthogonalScribe Atom/RSS Feed"><i type="Button" class="svg rss" title="OrthogonalScribe Atom/RSS Feed"></i></a><a class="js m-protected" href="#b3J0aG9nb25hbHNjcmliZUBnbWFpbC5jb20=" target="_blank" title="Mail"><i type="Button" class="svg mail" title="Mail"></i></a><a href="https://github.com/OrthogonalScribe/" target="_blank" title="Github"><i type="Button" class="svg github" title="Github"></i></a></div></nav>
      <p class="s90"> &copy; <span id="year">2024</span> OrthogonalScribe</p>
      <nav>
        <a class="s90" href="https://orthogonalscribe.github.io/sitemap.xml" target="_blank"> Sitemap </a>
      </nav>
      <p class="s90">Powered by <a href="https://www.getzola.org/" target="_blank">Zola</a> & <a href="https://github.com/jieiku/abridge/" target="_blank">Abridge</a></p>
    </div>
  </footer><span class="topout">
<span class="topleft"> </span><a href="#" class="top" title="Back to Top"><i class="svgs svgh angu"></i></a>
</span>
</body>
</html>
